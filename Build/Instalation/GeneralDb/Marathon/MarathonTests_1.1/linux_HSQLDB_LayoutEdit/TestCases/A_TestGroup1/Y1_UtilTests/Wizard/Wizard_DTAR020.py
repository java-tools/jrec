useFixture(wizard)

def test():
	from Modules import commonBits
	java_recorded_version = '1.6.0_0'

	if window('Wizard - Generate Copybooks'):
		select('FileChooser', commonBits.sampleDir() + 'DTAR020.bin')
##		click('Create Layout Wizard')


		select('BmKeyedComboBox', commonBits.fl('Fixed Length Binary')
)
##		select('BmKeyedComboBox', '2')
		select('TextField', 'cp037')
		click('Right')
		select('TabbedPane', '')
		select('TextField', '27')
		click('Right')
		select('TabbedPane', '')
		click('Right')
		select('TabbedPane', '')
		select('Table', 'product', commonBits.fl('Field Name') + ',0')
		select('Table', 'store', commonBits.fl('Field Name') + ',1')
		select('Table', 'date', commonBits.fl('Field Name') + ',2')
		select('Table', 'cell:' + commonBits.fl('Field Name') + ',2()')
		keystroke('Table', 'Down', commonBits.fl('Field Name') + ',2')
		select('Table', 'dept', commonBits.fl('Field Name') + ',3')
		select('Table', 'cell:' + commonBits.fl('Field Name') + ',3()')
		keystroke('Table', 'Down', commonBits.fl('Field Name') + ',3')
		select('Table', 'qty', commonBits.fl('Field Name') + ',4')
		select('Table', 'price', commonBits.fl('Field Name') + ',5')
		select('Table', '2', commonBits.fl('Decimal') + ',5')
		select('Table', 'cell:' + commonBits.fl('Decimal') + ',4(0)')
		assert_p('Table1', 'Content', '[[69684558, 20, 40118, 280, 1, 19.00], [69684558, 20, 40118, 280, -1, -19.00], [69684558, 20, 40118, 280, 1, 5.01], [69694158, 20, 40118, 280, 1, 19.00], [69694158, 20, 40118, 280, -1, -19.00], [69694158, 20, 40118, 280, 1, 5.01], [63604808, 20, 40118, 170, 1, 4.87], [62684671, 20, 40118, 685, 1, 69.99], [62684671, 20, 40118, 685, -1, -69.99], [64634429, 20, 40118, 957, 1, 3.99], [66624458, 20, 40118, 957, 1, 0.89], [63674861, 20, 40118, 957, 10, 2.70], [65674532, 20, 40118, 929, 1, 3.59], [64614401, 59, 40118, 957, 1, 1.99], [64614401, 59, 40118, 957, 1, 1.99], [61664713, 59, 40118, 335, 1, 17.99], [61664713, 59, 40118, 335, -1, -17.99], [68634752, 59, 40118, 410, 1, 8.99], [60614487, 59, 40118, 878, 1, 5.95], [63644339, 59, 40118, 878, 1, 12.65], [60694698, 59, 40118, 620, 1, 3.99], [60664659, 59, 40118, 620, 1, 3.99], [62684217, 59, 40118, 957, 1, 9.99], [67674686, 59, 40118, 929, 1, 3.99], [61684613, 59, 40118, 335, 1, 12.99], [64624770, 59, 40118, 957, 1, 2.59], [69694814, 166, 40118, 360, 1, 2.50], [69694814, 166, 40118, 360, 1, 2.50], [69644164, 166, 40118, 193, 1, 21.59], [62684907, 166, 40118, 375, 1, 13.99], [62694193, 166, 40118, 375, 1, 13.99], [62694193, 166, 40118, 375, -1, -13.99], [62694193, 166, 40118, 375, 1, 11.99], [63654450, 166, 40118, 320, 1, 13.99], [62664576, 166, 40118, 320, 1, 9.72], [63634260, 166, 40118, 320, 1, 5.59], [64684534, 166, 40118, 440, 1, 14.99], [64674965, 166, 40118, 235, 1, 19.99], [64674965, 166, 40118, 235, -1, -19.99], [64674965, 166, 40118, 235, 1, 12.00], [60624523, 166, 40118, 261, 1, 12.00], [66624253, 166, 40118, 957, 1, 3.49], [66624253, 166, 40118, 957, 1, 3.49], [64654284, 166, 40118, 957, 1, 3.99], [60684907, 166, 40118, 805, 1, 5.50], [63624299, 166, 40118, 870, 1, 10.99], [63624367, 166, 40118, 870, 1, 11.19], [62694575, 166, 40118, 475, 1, 14.99], [69614011, 166, 40118, 905, 1, 6.99], [62634996, 166, 40118, 650, 1, 9.99], [67634503, 166, 40118, 970, 1, 24.99], [65604476, 166, 40118, 830, 1, 19.95], [62694170, 166, 40118, 851, 1, 16.99], [63684098, 166, 40118, 410, 1, 1.98], [63684098, 166, 40118, 410, 1, 1.98], [63684098, 166, 40118, 410, 1, 1.98], [64674609, 166, 40118, 485, 1, 29.99], [62614014, 166, 40118, 366, 1, 14.99], [61694741, 166, 40118, 432, 1, 9.06], [62614534, 166, 40118, 432, 1, 9.09]]')
		select('Table', 'cell:' + commonBits.fl('Field Name') + ',2(date)')
		assert_p('Table', 'Content', '[[product, 1, 8, 6, 0, true], [store, 9, 2, 31, 0, true], [date, 11, 4, 31, 0, true], [dept, 15, 2, 31, 0, true], [qty, 17, 5, 31, 0, true], [price, 22, 6, 31, 2, true]]')
		select('Table', 'cell:' + commonBits.fl('Field Name') + ',2(date)')
		click('Right')
		select('TabbedPane', '')
		select('TextField', 'Wizard_DTAR020')
		click('Right')


	close()
