useFixture(default)

def test():
	from Modules import commonBits
	java_recorded_version = '1.5.0_11'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'Ams_VendorDownload_20041229.txt')
		click('Layout Wizard')
##		select('TextField2', 'Wizard - Ams Vendor Test')
##		select('BmKeyedComboBox2', '7')
		click('Right')
		#select('Table', '')
		rightclick('Table', 'D,0')
		#select('Table', '')
		rightclick('Table', 'G,0')
		#select('Table', '')
		rightclick('Table', 'G,0')
		#select('Table', '')
		rightclick('Table', 'L,0')
		#select('Table', '')
		rightclick('Table', 'T,0')
		#select('Table', '')
		rightclick('Table', 'Y,0')
		click('Right')
		select('Table', 'cell:Field Name,2()')
		assert_p('Table', 'Content', '[[, 1, 3, 0, 0, true], [, 4, 8, 0, 0, true], [, 12, 8, 0, 0, true], [, 20, 5, 0, 0, true], [, 25, 52, 0, 0, true]]')
		select('Table', 'cell:Field Name,2()')
		select('Table1', 'cell:B,1(00002100)')
		assert_p('Table1', 'Content', '[[TAR, 00010000, eee CLOT, HING , CO P/L                                    850PA  000], [TAR, 00002100, qqqqqq P, /L   ,                                           850PA  000], [TAR, 00012100, ssss FUN,  INTL,  P/L                                      850PA  000], [TAR, 00022100, jjjj FAS, HIONS,  P/L                                      850PA  000], [TAR, 00033100, A Compan, y    ,                                           850PA  000], [TAR, 00063100, CENTER I, NDL H,  K                                        850PA  000], [TAR, 00114100, MARTIN I, NDUST, RIES                                      850PA  000], [TAR, 00134100, DIST P/L,  (ADM, IN APPOINTED)                             850PA  000], [TAR, 00255100, SPECIALI, ST  M, ANAGEMENT                                 850PA  000], [TAR, 00305100, asdf IMP, ORT/E, XP P/L                                    850PA  000], [TAR, 00315100, qwerty F, LOWER, S P/L                                     850PA  000], [TAR, 00325100, TRADING , CO LT, D                                         850PA  000], [TAR, 00335100, DIST (UN, IVERS, AL) P/L                                   850PA  000], [TAR, 00465100, SHADES P, /L   ,                                           850PA  000], [TAR, 00706100, cccc BLI, SS P/, L                                         850PA  000], [TAR, 00747100, LINE DIS, T LTD,                                           850PA  000], [TAR, 00817100, ART ENT , CO LT, D                                         850PA  000], [TAR, 00828100, sss ddd , CANDL, E MANF CO                                 850PA  000], [TAR, 00838100, bbb & CO,  P/L ,                                           850PA  000], [TAR, 00848100, aaa MKT , P/L  ,                                           850PA  000], [TAR, 00058800, FOOD BRO, KERS ,                                           850PA  000]]')
		#select('Table1', '')
		select('Table', 'Brand', 'Field Name,0')
		select('Table', 'Vendor Number', 'Field Name,1')
		select('Table', 'Name pt 1', 'Field Name,2')
		select('Table', 'pt 2', 'Field Name,3')
		select('Table', 'p3', 'Field Name,4')
		select('Table', 'cell:Field Name,3(pt 2)')
		assert_p('Table', 'Content', '[[Brand, 1, 3, 0, 0, true], [Vendor Number, 4, 8, 0, 0, true], [Name pt 1, 12, 8, 0, 0, true], [pt 2, 20, 5, 0, 0, true], [p3, 25, 52, 0, 0, true]]')
		select('Table', 'cell:Field Name,3(pt 2)')
		select('Table1', 'cell:Vendor Number,1(00002100)')
		assert_p('Table1', 'Content', '[[TAR, 00010000, eee CLOT, HING , CO P/L                                    850PA  000], [TAR, 00002100, qqqqqq P, /L   ,                                           850PA  000], [TAR, 00012100, ssss FUN,  INTL,  P/L                                      850PA  000], [TAR, 00022100, jjjj FAS, HIONS,  P/L                                      850PA  000], [TAR, 00033100, A Compan, y    ,                                           850PA  000], [TAR, 00063100, CENTER I, NDL H,  K                                        850PA  000], [TAR, 00114100, MARTIN I, NDUST, RIES                                      850PA  000], [TAR, 00134100, DIST P/L,  (ADM, IN APPOINTED)                             850PA  000], [TAR, 00255100, SPECIALI, ST  M, ANAGEMENT                                 850PA  000], [TAR, 00305100, asdf IMP, ORT/E, XP P/L                                    850PA  000], [TAR, 00315100, qwerty F, LOWER, S P/L                                     850PA  000], [TAR, 00325100, TRADING , CO LT, D                                         850PA  000], [TAR, 00335100, DIST (UN, IVERS, AL) P/L                                   850PA  000], [TAR, 00465100, SHADES P, /L   ,                                           850PA  000], [TAR, 00706100, cccc BLI, SS P/, L                                         850PA  000], [TAR, 00747100, LINE DIS, T LTD,                                           850PA  000], [TAR, 00817100, ART ENT , CO LT, D                                         850PA  000], [TAR, 00828100, sss ddd , CANDL, E MANF CO                                 850PA  000], [TAR, 00838100, bbb & CO,  P/L ,                                           850PA  000], [TAR, 00848100, aaa MKT , P/L  ,                                           850PA  000], [TAR, 00058800, FOOD BRO, KERS ,                                           850PA  000]]')
		select('Table1', 'cell:Vendor Number,2(00012100)')
		assert_p('Table1', 'Text', '00012100', 'Vendor Number,2')
		select('Table1', 'cell:Vendor Number,2(00012100)')
		click('Right')


		#   Save Layout panel
		#   -----------------
		select('TabbedPane', '')
		select('TextField', 'Wizard - Ams Vendor Test')
##		select('BmKeyedComboBox', '7')
		select('BmKeyedComboBox', 'Ams')
		click('Right')

		select('Table', 'cell:4 - 8|Vendor Number,0(00010000)')
		rightclick('Table', '4 - 8|Vendor Number,0')
		select_menu('Edit Record')
		select('Table', 'cell:Data,3(HING)')
		assert_p('Table', 'Content', '[[Brand, 1, 3, TAR, TAR], [Vendor Number, 4, 8, 00010000, 00010000], [Name pt 1, 12, 8, eee CLOT, eee CLOT], [pt 2, 20, 5, HING, HING], [p3, 25, 52, CO P/L                                    850PA  000, CO P/L                                    850PA  000]]')
		select('Table', 'cell:Data,3(HING)')
		click('Right')
		select('Table', 'cell:Data,2(qqqqqq P)')
		assert_p('Table', 'Content', '[[Brand, 1, 3, TAR, TAR], [Vendor Number, 4, 8, 00002100, 00002100], [Name pt 1, 12, 8, qqqqqq P, qqqqqq P], [pt 2, 20, 5, /L, /L], [p3, 25, 52,                                           850PA  000,                                           850PA  000]]')
		select('Table', 'cell:Data,2(qqqqqq P)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		commonBits.setRecordLayout(select, 'ams Vendor Download')
		click('Edit1')
		select('Table', 'cell:4 - 8|Vendor,0(10000)')
		rightclick('Table', '4 - 8|Vendor,0')
		select_menu('Edit Record')
		select('Table', 'cell:Data,2(eee CLOTHING CO P/L)')
		assert_p('Table', 'Content', '[[Business, 1, 3, TAR, TAR], [Vendor, 4, 8, 10000, 00010000], [Vendor Name, 12, 40, eee CLOTHING CO P/L, eee CLOTHING CO P/L], [Filler, 52, 15, , ], [850, 67, 3, 850, 850], [P, 70, 1, P, P], [Filler, 72, 2, , ], [000, 74, 3, 000, 000]]')
		select('Table', 'cell:Data,2(eee CLOTHING CO P/L)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select_menu('Record Layouts>>Edit Layout')
		select('TextField', 'W%')
		select('TextField1', '%')
		#select('TabbedPane', 'Extras')
		#select('TabbedPane', 'Fields')
		#select('TabbedPane', 'Extras')
		#select('TabbedPane', 'Fields')
		#select('Table', 'cell:Description,0()')
		click('Delete3')

		if window('Delete: Wizard - Ams Vendor Test'):
			click('No')
		close()

		select('RecordFieldsJTbl', 'cell:FieldName,1(Vendor Number)')
		assert_p('RecordFieldsJTbl', 'Content', '[[1, 3, Brand, , 0, 0, 0, , , ], [4, 8, Vendor Number, , 0, 0, 0, , , ], [12, 8, Name pt 1, , 0, 0, 0, , , ], [20, 5, pt 2, , 0, 0, 0, , , ], [25, 52, p3, , 0, 0, 0, , , ]]')
		select('RecordFieldsJTbl', 'cell:FieldName,2(Name pt 1)')
		assert_p('RecordFieldsJTbl', 'Text', 'cell:FieldName,2(Name pt 1)')
		select('RecordFieldsJTbl', 'cell:FieldName,0(Brand)')
		assert_p('RecordFieldsJTbl', 'Text', 'cell:FieldName,0(Brand)')
		select('RecordFieldsJTbl', 'cell:FieldName,3(pt 2)')
		click('Delete3')

		if window('Delete: Wizard - Ams Vendor Test'):
			click('Yes')
		close()

		#select('TabbedPane', 'Extras')
		#select('TabbedPane', 'Fields')
		#select('TabbedPane', 'Extras')
		#select('TabbedPane', 'Fields')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
	close()
