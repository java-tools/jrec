useFixture(default)

def test():
	from Modules import commonBits
	java_recorded_version = '1.7.0_51'

	if window(commonBits.applicationName()):
		select('File_Txt', commonBits.sampleDir() + 'FieldTestOptional.bin')
		select('File Structure_Txt', 'Delimited Messages')
		select('Proto Definition_Txt', commonBits.stdCopybookDir() + 'FieldTestOptional.proto')
		click('Edit1')
		select('TabbedPane', 'Record:')
		select('LineFrame.FileDisplay_JTbl', '11', 'Data,0')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,0()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,0')
		select('LineFrame.FileDisplay_JTbl', '22', 'Data,1')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,1()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,1')
		select('LineFrame.FileDisplay_JTbl', '33', 'Data,2')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,2()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,2')
		select('LineFrame.FileDisplay_JTbl', '44', 'Data,3')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,3()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,3')
		select('LineFrame.FileDisplay_JTbl', '55', 'Data,4')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,4()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,4')
		select('LineFrame.FileDisplay_JTbl', '66', 'Data,5')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,5()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,5')
		select('LineFrame.FileDisplay_JTbl', '77', 'Data,6')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,6()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,6')
		select('LineFrame.FileDisplay_JTbl', '88', 'Data,7')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,7()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,7')
		select('LineFrame.FileDisplay_JTbl', '99', 'Data,8')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,8()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,8')
		select('LineFrame.FileDisplay_JTbl', '10', 'Data,9')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,9()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,9')
		select('LineFrame.FileDisplay_JTbl', '222', 'Data,10')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,10()')
		keystroke('LineFrame.FileDisplay_JTbl', 'Down', 'Data,10')
		select('LineFrame.FileDisplay_JTbl', '333.0', 'Data,11')
		select('LineFrame.FileDisplay_JTbl', 'true', 'Data,12')
		select('LineFrame.FileDisplay_JTbl', '555', 'Data,13')
		select('LineFrame.FileDisplay_JTbl', 'RETURN', 'Data,14')
		select('LineFrame.FileDisplay_JTbl', '77', 'Data,15')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,15(77)')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, 55, 55], [f06, 6, , INT64, 66, 66], [f07, 7, , SINT64, 77, 77], [f08, 8, , SFIXED64, 88, 88], [f09, 9, , UINT64, 99, 99], [f10, 10, , FIXED64, 10, 10], [f11, 11, , FLOAT, 222.0, 222.0], [f12, 12, , DOUBLE, 333.0, 333.0], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, 555, 555], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, 77, 77]]')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,15(77)')
		click('DisplayFrame$TabButton', 33, 22)
		select('TabbedPane', 'Table:')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[11, 22, 33, 44, 55, 66, 77, 88, 99, 10, 222.0, 333.0, true, 555, RETURN, 77]]')
		click('Record: 1')
		select('TabbedPane', 'Record:')
		
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,15')
		select_menu('Clear Field')
		
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,15()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, 55, 55], [f06, 6, , INT64, 66, 66], [f07, 7, , SINT64, 77, 77], [f08, 8, , SFIXED64, 88, 88], [f09, 9, , UINT64, 99, 99], [f10, 10, , FIXED64, 10, 10], [f11, 11, , FLOAT, 222.0, 222.0], [f12, 12, , DOUBLE, 333.0, 333.0], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, 555, 555], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,13')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,13()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, 55, 55], [f06, 6, , INT64, 66, 66], [f07, 7, , SINT64, 77, 77], [f08, 8, , SFIXED64, 88, 88], [f09, 9, , UINT64, 99, 99], [f10, 10, , FIXED64, 10, 10], [f11, 11, , FLOAT, 222.0, 222.0], [f12, 12, , DOUBLE, 333.0, 333.0], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,11')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,11()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, 55, 55], [f06, 6, , INT64, 66, 66], [f07, 7, , SINT64, 77, 77], [f08, 8, , SFIXED64, 88, 88], [f09, 9, , UINT64, 99, 99], [f10, 10, , FIXED64, 10, 10], [f11, 11, , FLOAT, 222.0, 222.0], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,10')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,10()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, 55, 55], [f06, 6, , INT64, 66, 66], [f07, 7, , SINT64, 77, 77], [f08, 8, , SFIXED64, 88, 88], [f09, 9, , UINT64, 99, 99], [f10, 10, , FIXED64, 10, 10], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,9')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Data,8(99)')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, 55, 55], [f06, 6, , INT64, 66, 66], [f07, 7, , SINT64, 77, 77], [f08, 8, , SFIXED64, 88, 88], [f09, 9, , UINT64, 99, 99], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,8')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,8()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, 55, 55], [f06, 6, , INT64, 66, 66], [f07, 7, , SINT64, 77, 77], [f08, 8, , SFIXED64, 88, 88], [f09, 9, , UINT64, , ], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,7')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,7()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, 55, 55], [f06, 6, , INT64, 66, 66], [f07, 7, , SINT64, 77, 77], [f08, 8, , SFIXED64, , ], [f09, 9, , UINT64, , ], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,6')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,6()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, 55, 55], [f06, 6, , INT64, 66, 66], [f07, 7, , SINT64, , ], [f08, 8, , SFIXED64, , ], [f09, 9, , UINT64, , ], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,5')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,5()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, 55, 55], [f06, 6, , INT64, , ], [f07, 7, , SINT64, , ], [f08, 8, , SFIXED64, , ], [f09, 9, , UINT64, , ], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,4')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,4()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, 33, 33], [f04, 4, , UINT32, 44, 44], [f05, 5, , FIXED32, , ], [f06, 6, , INT64, , ], [f07, 7, , SINT64, , ], [f08, 8, , SFIXED64, , ], [f09, 9, , UINT64, , ], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,4()')
		click('DisplayFrame$TabButton', 33, 21)
		select('TabbedPane', 'Table:')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[11, 22, 33, 44, , , , , , , , , true, , RETURN, ]]')
		select('LineList.FileDisplay_JTbl', '', '4|f04,0')
		select('LineList.FileDisplay_JTbl', 'cell:5|f05,0()')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[11, 22, 33, , , , , , , , , , true, , RETURN, ]]')
		select('LineList.FileDisplay_JTbl', '', '3|f03,0')
		select('LineList.FileDisplay_JTbl', 'cell:4|f04,0()')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[11, 22, , , , , , , , , , , true, , RETURN, ]]')
		select('LineList.FileDisplay_JTbl', 'cell:4|f04,0()')
		click('Record: 1')
		select('TabbedPane', 'Record:')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, 22, 22], [f03, 3, , SFIXED32, , ], [f04, 4, , UINT32, , ], [f05, 5, , FIXED32, , ], [f06, 6, , INT64, , ], [f07, 7, , SINT64, , ], [f08, 8, , SFIXED64, , ], [f09, 9, , UINT64, , ], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,1')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,1()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, 11, 11], [f02, 2, , SINT32, , ], [f03, 3, , SFIXED32, , ], [f04, 4, , UINT32, , ], [f05, 5, , FIXED32, , ], [f06, 6, , INT64, , ], [f07, 7, , SINT64, , ], [f08, 8, , SFIXED64, , ], [f09, 9, , UINT64, , ], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,0')
		select_menu('Clear Field')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,0()')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, , ], [f02, 2, , SINT32, , ], [f03, 3, , SFIXED32, , ], [f04, 4, , UINT32, , ], [f05, 5, , FIXED32, , ], [f06, 6, , INT64, , ], [f07, 7, , SINT64, , ], [f08, 8, , SFIXED64, , ], [f09, 9, , UINT64, , ], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, true, true], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
		select('LineFrame.FileDisplay_JTbl', 'cell:Text,0()')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,12')
		select_menu('Clear Field')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, , ], [f02, 2, , SINT32, , ], [f03, 3, , SFIXED32, , ], [f04, 4, , UINT32, , ], [f05, 5, , FIXED32, , ], [f06, 6, , INT64, , ], [f07, 7, , SINT64, , ], [f08, 8, , SFIXED64, , ], [f09, 9, , UINT64, , ], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, , ], [f15, 14, , STRING, , ], [f17, 15, , ENUM, RETURN, RETURN], [f19, 16, , BYTES, , ]]')
##		select('LineFrame.FileDisplay_JTbl', '')
		rightclick('LineFrame.FileDisplay_JTbl', 'Data,14')
		select_menu('Clear Field')
		assert_p('LineFrame.FileDisplay_JTbl', 'Content', '[[f01, 1, , INT32, , ], [f02, 2, , SINT32, , ], [f03, 3, , SFIXED32, , ], [f04, 4, , UINT32, , ], [f05, 5, , FIXED32, , ], [f06, 6, , INT64, , ], [f07, 7, , SINT64, , ], [f08, 8, , SFIXED64, , ], [f09, 9, , UINT64, , ], [f10, 10, , FIXED64, , ], [f11, 11, , FLOAT, , ], [f12, 12, , DOUBLE, , ], [f13, 13, , BOOL, , ], [f15, 14, , STRING, , ], [f17, 15, , ENUM, , ], [f19, 16, , BYTES, , ]]')
		click('Table:')
		select('TabbedPane', 'Table:')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[, , , , , , , , , , , , , , , ]]')
		click('Delete2')
##		click('BasicInternalFrameTitlePane$NoFocusButton2')

##		if window(r'Save Changes to file: G:\Users\BruceTst01\.RecordEditor\ProtoBuf\SampleFiles\FieldTestOptional.bin'):
##			click('No')
##		close()
	close()
