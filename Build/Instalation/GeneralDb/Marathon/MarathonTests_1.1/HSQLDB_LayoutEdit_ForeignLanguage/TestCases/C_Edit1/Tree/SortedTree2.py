useFixture(RecordEditor)

def test():
	from Modules import commonBits
	java_recorded_version = '1.5.0_11'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'DTAR020.bin')
		commonBits.setRecordLayout(select, 'DTAR020')

		click(commonBits.fl('Edit') + '1')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Sorted Field Tree'))
#		select('List', 'DTAR020')
		select('Table', 'STORE-NO', commonBits.fl('Field') + ',0')
		select('Table', 'DEPT-NO', commonBits.fl('Field') + ',1')
		select('Table', 'cell:' + commonBits.fl('Field') + ',1(DEPT-NO)')
		click(commonBits.fl('Build Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,0(null)')
		assert_p('JTreeTable', 'RowCount', '4')
		select('JTreeTable', 'cell:KEYCODE-NO,0(null)')
		rightclick('JTreeTable', 'STORE-NO,0')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell: ,2(null)')
		assert_p('JTreeTable', 'RowCount', '9')
		select('JTreeTable', 'cell: ,2(null)')
		rightclick('JTreeTable', 'STORE-NO,2')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,3(69684558)')
		assert_p('JTreeTable', 'Text', '69684558', 'KEYCODE-NO,3')
		select('JTreeTable', 'cell:KEYCODE-NO,4(69684558)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , 69684558, 20, 40118, 280, 1, 19.00], [, , 69684558, 20, 40118, 280, -1, -19.00], [, , 69684558, 20, 40118, 280, 1, 5.01], [, , 69694158, 20, 40118, 280, 1, 19.00], [, , 69694158, 20, 40118, 280, -1, -19.00], [, , 69694158, 20, 40118, 280, 1, 5.01], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ]]')
		select('JTreeTable', 'cell:KEYCODE-NO,5(69684558)')
		assert_p('JTreeTable', 'RowCount', '15')
		select('JTreeTable', 'cell:KEYCODE-NO,5(69684558)')
		rightclick('JTreeTable', 'STORE-NO,9')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,10(62684671)')
		assert_p('JTreeTable', 'Text', '62684671', 'KEYCODE-NO,10')
		select('JTreeTable', 'cell:KEYCODE-NO,11(62684671)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , 69684558, 20, 40118, 280, 1, 19.00], [, , 69684558, 20, 40118, 280, -1, -19.00], [, , 69684558, 20, 40118, 280, 1, 5.01], [, , 69694158, 20, 40118, 280, 1, 19.00], [, , 69694158, 20, 40118, 280, -1, -19.00], [, , 69694158, 20, 40118, 280, 1, 5.01], [, , , , , , , ], [, , 62684671, 20, 40118, 685, 1, 69.99], [, , 62684671, 20, 40118, 685, -1, -69.99], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ]]')
		select('JTreeTable', 'cell:KEYCODE-NO,10(62684671)')
		assert_p('JTreeTable', 'RowCount', '17')
		select('JTreeTable', 'cell:KEYCODE-NO,10(62684671)')
		rightclick('JTreeTable', 'STORE-NO,2')
		select_menu(commonBits.fl('Collapse Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,4(62684671)')
		assert_p('JTreeTable', 'Text', '62684671', 'KEYCODE-NO,4')
		select('JTreeTable', 'cell:KEYCODE-NO,5(62684671)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , 62684671, 20, 40118, 685, 1, 69.99], [, , 62684671, 20, 40118, 685, -1, -69.99], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ]]')
		select('JTreeTable', 'cell:KEYCODE-NO,4(62684671)')
		assert_p('JTreeTable', 'RowCount', '11')
		select('JTreeTable', 'cell:KEYCODE-NO,0(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,0')
		select_menu(commonBits.fl('Collapse Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,0(null)')
		assert_p('JTreeTable', 'RowCount', '4')
		select('JTreeTable', 'cell:STORE-NO,0(null)')
		rightclick('JTreeTable', 'STORE-NO,0')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,1(null)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , 62684671, 20, 40118, 685, 1, 69.99], [, , 62684671, 20, 40118, 685, -1, -69.99], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ]]')
		select('JTreeTable', 'cell:KEYCODE-NO,2(null)')
		assert_p('JTreeTable', 'RowCount', '11')
		select('JTreeTable', 'cell:KEYCODE-NO,4(62684671)')
		assert_p('JTreeTable', 'Text', 'cell:KEYCODE-NO,4(62684671)')
		select('JTreeTable', 'cell:KEYCODE-NO,4(62684671)')
		rightclick('JTreeTable', 'STORE-NO,7')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,8(64634429)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , 62684671, 20, 40118, 685, 1, 69.99], [, , 62684671, 20, 40118, 685, -1, -69.99], [, , , , , , , ], [, , , , , , , ], [, , 64634429, 20, 40118, 957, 1, 3.99], [, , 66624458, 20, 40118, 957, 1, 0.89], [, , 63674861, 20, 40118, 957, 10, 2.70], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ]]')
		select('JTreeTable', 'cell:KEYCODE-NO,9(66624458)')
		rightclick('JTreeTable', 'KEYCODE-NO,9')
		select_menu(commonBits.fl('Edit Record'))
		select('JTreeTable', 'cell:KEYCODE-NO,9(66624458)')
		select('Table', 'cell:' + commonBits.fl('Data') + ',0(66624458)')
		assert_p('Table', 'Text', '20', commonBits.fl('Data') + ',1')
		select('Table', 'cell:' + commonBits.fl('Data') + ',0(66624458)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
	close()
