useFixture(RecordEditor)

def test():
	from Modules import commonBits
	java_recorded_version = '1.6.0_17'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'Ams_PODownload_20041231.txt')
		click(commonBits.fl('Edit') + '1')
		select('Table', 'cell:3 - 4|DC Number 1,0(4534)')
		rightclick('Table', '1 - 2|Record Type,1')
		select('Table', 'cell:3 - 4|DC Number 1,0(4534)')
		rightclick('Table', '1 - 2|Record Type,1')
		select_menu(commonBits.fl('Edit Record'))
##		select('Table1', 'cell:3 - 4|DC Number 1,0(4534)')
		select('Table', '17.0000', commonBits.fl('Data') + ',1')
		select('Table', '0.0102', commonBits.fl('Data') + ',2')
		select('Table', 'cell:' + commonBits.fl('Data') + ',4()')
		assert_p('Table', 'Content', '[[Record Type, 1, 2, D1, D1], [Pack Qty, 3, 9, 17.0000, 000170000], [Pack Cost, 12, 13, 0.0102, 0000000000102], [APN, 25, 13, 2222500000000, 2222500000000], [Filler, 38, 1, , ], [Product, 39, 8, 43314531, 43314531], [pmg dtl tech key, 72, 15, 2075359, 2075359], [Case Pack id, 87, 15, 45614531, 45614531], [Product Name, 101, 50,  DONKEY 24-006607 SHWL WRAP CARD,  DONKEY 24-006607 SHWL WRAP CARD]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',4()')
		click('Right')
		select('Table', '10', commonBits.fl('Data') + ',2')
		select('Table', '9045', commonBits.fl('Data') + ',3')
		select('Table', '2', commonBits.fl('Data') + ',4')
		select('Table', 'cell:' + commonBits.fl('Data') + ',5(5076)')
		click('Right')
		click('Left')
		assert_p('Table', 'Content', '[[Record Type, 1, 2, S1, S1], [DC Number 1, 3, 4, 5043, 5043], [Pack Quantity 1, 7, 8, 10, 00000010], [DC Number 2, 15, 4, 9045, 9045], [Pack Quantity 2, 19, 8, 2, 00000002], [DC Number 4, 39, 4, 5076, 5076], [Pack Quantity 4, 43, 8, 1, 00000001], [DC Number 5, 51, 4, 5079, 5079], [Pack Quantity 5, 55, 8, 1, 00000001], [DC Number 6, 63, 4, 5151, 5151], [Pack Quantity 6, 67, 8, 1, 00000001], [DC Number 7, 75, 4, 5072, 5072], [Pack Quantity 7, 79, 8, 1, 00000001], [DC Number 8, 87, 4, , ], [Pack Quantity 8, 91, 8, 0, 00000000], [DC Number 9, 99, 4, , ], [Pack Quantity 9, 103, 8, 0, 00000000], [DC Number 10, 111, 4, , ], [Pack Quantity 10, 115, 8, 0, 00000000]]')
		click('Right')
		select('Table', '14.0000', commonBits.fl('Data') + ',1')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(148.3200)')
		assert_p('Table', 'Content', '[[Record Type, 1, 2, D1, D1], [Pack Qty, 3, 9, 14.0000, 000140000], [Pack Cost, 12, 13, 148.3200, 0000001483200], [APN, 25, 13, 0, 0000000000000], [Filler, 38, 1, , ], [Product, 39, 8, 5614944, 05614944], [pmg dtl tech key, 72, 15, 2075360, 2075360], [Case Pack id, 87, 15, 5614944, 5614944], [Product Name, 101, 50,  MILK 24-006607 SHWL WRAP CARD,  MILK 24-006607 SHWL WRAP CARD]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(148.3200)')
		click('Right')
		select('Table', '11', commonBits.fl('Data') + ',2')
		select('Table', 'cell:' + commonBits.fl('Data') + ',4(1)')
		assert_p('Table', 'Content', '[[Record Type, 1, 2, S1, S1], [DC Number 1, 3, 4, 5045, 5045], [Pack Quantity 1, 7, 8, 11, 00000011], [DC Number 2, 15, 4, 5076, 5076], [Pack Quantity 2, 19, 8, 1, 00000001], [DC Number 4, 39, 4, 3331, 3331], [Pack Quantity 4, 43, 8, 49440001, 49440001], [DC Number 5, 51, 4, , ], [Pack Quantity 5, 55, 8, 0, 00000000], [DC Number 6, 63, 4, , ], [Pack Quantity 6, 67, 8, 0, 00000000], [DC Number 7, 75, 4, , ], [Pack Quantity 7, 79, 8, 0, 00000000], [DC Number 8, 87, 4, , ], [Pack Quantity 8, 91, 8, 0, 00000000], [DC Number 9, 99, 4, , ], [Pack Quantity 9, 103, 8, 0, 00000000], [DC Number 10, 111, 4, , ], [Pack Quantity 10, 115, 8, 0, 00000000]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',4(1)')
		click('Right')
		select('Table', '8.0000', commonBits.fl('Data') + ',1')
		##select('Table', 'cell:' + commonBits.fl('Data') + ',4()')
		assert_p('Table', 'Content', '[[Record Type, 1, 2, D1, D1], [Pack Qty, 3, 9, 8.0000, 000080000], [Pack Cost, 12, 13, 148.3200, 0000001483200], [APN, 25, 13, 0, 0000000000000], [Filler, 38, 1, , ], [Product, 39, 8, 55615071, 55615071], [pmg dtl tech key, 72, 15, 2075361, 2075361], [Case Pack id, 87, 15, 55615071, 55615071], [Product Name, 101, 50,  M.ROSE 24-006607 SHWL WRAP CARD,  M.ROSE 24-006607 SHWL WRAP CARD]]')
		select('Table', '48.3200', commonBits.fl('Data') + ',2')
		select('Table', '48.3200', commonBits.fl('Data') + ',2')

		##select('Table', '48.3200', 'Data,2')

		select('Table', 'cell:' + commonBits.fl('Data') + ',4()')
		assert_p('Table', 'Content', '[[Record Type, 1, 2, D1, D1], [Pack Qty, 3, 9, 8.0000, 000080000], [Pack Cost, 12, 13, 48.3200, 0000000483200], [APN, 25, 13, 0, 0000000000000], [Filler, 38, 1, , ], [Product, 39, 8, 55615071, 55615071], [pmg dtl tech key, 72, 15, 2075361, 2075361], [Case Pack id, 87, 15, 55615071, 55615071], [Product Name, 101, 50,  M.ROSE 24-006607 SHWL WRAP CARD,  M.ROSE 24-006607 SHWL WRAP CARD]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',4()')
		click('Right')
		select('Table', '6', commonBits.fl('Data') + ',2')
		select('Table', '51', commonBits.fl('Data') + ',4')
		select('Table', 'cell:' + commonBits.fl('Data') + ',5(3331)')
		assert_p('Table', 'Content', '[[Record Type, 1, 2, S1, S1], [DC Number 1, 3, 4, 5036, 5036], [Pack Quantity 1, 7, 8, 6, 00000006], [DC Number 2, 15, 4, 5043, 5043], [Pack Quantity 2, 19, 8, 51, 00000051], [DC Number 4, 39, 4, 3331, 3331], [Pack Quantity 4, 43, 8, 50710003, 50710003], [DC Number 5, 51, 4, 5065, 5065], [Pack Quantity 5, 55, 8, 4, 00000004], [DC Number 6, 63, 4, 5069, 5069], [Pack Quantity 6, 67, 8, 4, 00000004], [DC Number 7, 75, 4, 5076, 5076], [Pack Quantity 7, 79, 8, 4, 00000004], [DC Number 8, 87, 4, 5079, 5079], [Pack Quantity 8, 91, 8, 2, 00000002], [DC Number 9, 99, 4, 5094, 5094], [Pack Quantity 9, 103, 8, 4, 00000004], [DC Number 10, 111, 4, 5128, 5128], [Pack Quantity 10, 115, 8, 3, 00000003]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',5(3331)')
		
#		if commonBits.isVersion80():
#			select_menu('Edit>>Compare with Disk')
#		else:
		commonBits.selectOldFilemenu(select_menu, 'Utilities', 'Compare with Disk')
##		select('Table1', 'cell:' + commonBits.fl('Data') + ',5(3331)')
		assert_p('Table', 'Enabled', 'true')

		assert_p('Table', 'Content', '[[, Old, 2, D1, 7.0000, 0.0002, 2222500000000, , 43314531, 2075359, 45614531,  DONKEY 24-006607 SHWL WRAP CARD, , , , , , , , , , ], [, New, 2, , 17.0000, 0.0102, , , , , , , , , , , , , , , , ], [, Old, 3, S1, 5043, 1, 5045, 1, 5076, 1, 5079, 1, 5151, 1, 5072, 1, , 0, , 0, , 0], [, New, 3, , , 10, 9045, 2, , , , , , , , , , , , , , ], [, Old, 4, D1, 4.0000, 148.3200, 0, , 5614944, 2075360, 5614944,  MILK 24-006607 SHWL WRAP CARD, , , , , , , , , , ], [, New, 4, , 14.0000, , , , , , , , , , , , , , , , , ], [, Old, 5, S1, 5045, 1, 5076, 1, 3331, 49440001, , 0, , 0, , 0, , 0, , 0, , 0], [, New, 5, , , 11, , , , , , , , , , , , , , , , ], [, Old, 6, D1, 48.0000, 148.3200, 0, , 55615071, 2075361, 55615071,  M.ROSE 24-006607 SHWL WRAP CARD, , , , , , , , , , ], [, New, 6, , 8.0000, 48.3200, , , , , , , , , , , , , , , , ], [, Old, 7, S1, 5036, 3, 5043, 5, 3331, 50710003, 5065, 4, 5069, 4, 5076, 4, 5079, 2, 5094, 4, 5128, 3], [, New, 7, , , 6, , 51, , , , , , , , , , , , , , ]]')

		if commonBits.isNimbusLook():
			assert_p('Table', 'Foreground', '[r=35,g=35,b=36]')
		else:
			assert_p('Table', 'Foreground', '[r=51,g=51,b=51]')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
#		select('Table', 'cell:' + commonBits.fl('Data') + ',5(3331)')
##		select('Table', 'cell:' + commonBits.fl('Data') + ',5(3331)')
		select_menu(commonBits.fl('Window') + '>>Ams_PODownload_20041231.txt>>' + commonBits.fl('Record:'))
		select('Table', 'cell:' + commonBits.fl('Data') + ',5(3331)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('Table', 'cell:3 - 4|DC Number 1,0(4534)')
		select('Table', 'cell:3 - 4|DC Number 1,0(4534)')
		select_menu(commonBits.fl('Window') + '>>Ams_PODownload_20041231.txt>>' + commonBits.fl('Table:'))
		select('Table', 'cell:3 - 4|DC Number 1,0(4534)')
		if commonBits.isVersion81():
			click('Export')
		else:
			click('SaveAs')
		select('FileChooser', commonBits.sampleDir() + 'Ams_PODownload_20041231_Compare.txt')
		click(commonBits.fl('Save File'))
		select('Table', 'cell:3 - 4|DC Number 1,0(4534)')
		select('Table', 'cell:3 - 4|DC Number 1,0(4534)')
	close()
