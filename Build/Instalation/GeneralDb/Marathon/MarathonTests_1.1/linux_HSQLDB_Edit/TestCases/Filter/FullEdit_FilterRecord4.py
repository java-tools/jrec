useFixture(RecordEditor)

def test():
	from Modules import commonBits
	java_recorded_version = '1.5.0_11'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'Ams_PODownload_20050101.txt')
		click(commonBits.fl('Edit') + '1')
		click('Filter1')
		select('Table', 'false', commonBits.fl('Include') + ',0')
		select('Table', 'false', commonBits.fl('Include') + ',2')
		select('Table', 'cell:' + commonBits.fl('Record') + ',1(ams PO Download: Header)')
		select('Table1', 'false', commonBits.fl('Include') + ',0')
		select('Table1', 'false', commonBits.fl('Include') + ',1')
		select('Table1', 'false', commonBits.fl('Include') + ',6')
		select('Table1', 'false', commonBits.fl('Include') + ',7')
		select('Table1', 'false', commonBits.fl('Include') + ',5')
		#select('Table1', 'cell:' + commonBits.fl('Include') + ',5(false)')
		select('Table2', 'Vendor', commonBits.fl('Field') + ',0')
		select('Table2', ' = ', commonBits.fl('Operator') + ',0')
		select('Table2', '5110', commonBits.fl('Value') + ',0')
		select('Table2', 'cell:' + commonBits.fl('Value') + ',0()')
		commonBits.filter(click)

		select('Table', 'cell:30 - 6|Entry Date,0(040929)')
		assert_p('Table', 'Content', '[[5110, 211985, 040929, 200, 050103, 050107, , , , LADIES KNI, C, FT], [5110, 211987, 040929, 200, 050103, 050106, , , , LADIES KNI, C, FT]]')
		select('Table', 'cell:52 - 6|Expected Reciept Date,1(050103)')
		assert_p('Table', 'RowCount', '2')
		select('Table', 'cell:52 - 6|Expected Reciept Date,1(050103)')
		rightclick('Table', '18 - 12|PO,0')
		select('Table', 'cell:18 - 12|PO,0(211985)')
		rightclick('Table', '18 - 12|PO,0')
		select_menu(commonBits.fl('Edit Record'))
##		select('Table1', 'cell:18 - 12|PO,0(211985)')
		select('Table', 'cell:' + commonBits.fl('Data') + ',4(050103)')
		assert_p('Table', 'Content', '[[Vendor, 8, 10, 5110, 0000005110], [PO, 18, 12, 211985, 000000211985], [Entry Date, 30, 6, 040929, 040929], [Department, 48, 4, 200, 200], [Expected Reciept Date, 52, 6, 050103, 050103], [Cancel by date, 58, 6, 050107, 050107], [EDI Type, 68, 1, , ], [Add Date, 69, 6, , ], [Filler, 75, 1, , ], [Department Name, 76, 10, LADIES KNI, LADIES KNI], [Prcoess Type, 86, 1, C, C], [Order Type, 87, 2, FT, FT]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',5(050107)')
		rightclick('Table', commonBits.fl('Data') + ',5')
		select('Table', 'cell:' + commonBits.fl('Data') + ',5(050107)')
		assert_p('Table', 'Content', '[[Vendor, 8, 10, 5110, 0000005110], [PO, 18, 12, 211985, 000000211985], [Entry Date, 30, 6, 040929, 040929], [Department, 48, 4, 200, 200], [Expected Reciept Date, 52, 6, 050103, 050103], [Cancel by date, 58, 6, 050107, 050107], [EDI Type, 68, 1, , ], [Add Date, 69, 6, , ], [Filler, 75, 1, , ], [Department Name, 76, 10, LADIES KNI, LADIES KNI], [Prcoess Type, 86, 1, C, C], [Order Type, 87, 2, FT, FT]]')
		select('Table', '201', commonBits.fl('Data') + ',3')
		select('Table', 'cell:' + commonBits.fl('Text') + ',3(201)')
		rightclick('Table', commonBits.fl('Text') + ',3')
		select('Table', 'cell:' + commonBits.fl('Text') + ',3(201)')
		assert_p('Table', 'Text', '201', commonBits.fl('Text') + ',3')
		select('Table', 'cell:' + commonBits.fl('Data') + ',4(050103)')
		assert_p('Table', 'Content', '[[Vendor, 8, 10, 5110, 0000005110], [PO, 18, 12, 211985, 000000211985], [Entry Date, 30, 6, 040929, 040929], [Department, 48, 4, 201, 201], [Expected Reciept Date, 52, 6, 050103, 050103], [Cancel by date, 58, 6, 050107, 050107], [EDI Type, 68, 1, , ], [Add Date, 69, 6, , ], [Filler, 75, 1, , ], [Department Name, 76, 10, LADIES KNI, LADIES KNI], [Prcoess Type, 86, 1, C, C], [Order Type, 87, 2, FT, FT]]')
		select('Table', '200', commonBits.fl('Data') + ',3')
		select('Table', 'cell:' + commonBits.fl('Data') + ',4(050103)')
		assert_p('Table', 'Content', '[[Vendor, 8, 10, 5110, 0000005110], [PO, 18, 12, 211985, 000000211985], [Entry Date, 30, 6, 040929, 040929], [Department, 48, 4, 200, 200], [Expected Reciept Date, 52, 6, 050103, 050103], [Cancel by date, 58, 6, 050107, 050107], [EDI Type, 68, 1, , ], [Add Date, 69, 6, , ], [Filler, 75, 1, , ], [Department Name, 76, 10, LADIES KNI, LADIES KNI], [Prcoess Type, 86, 1, C, C], [Order Type, 87, 2, FT, FT]]')
		select('Table', 'LADIES KNw', commonBits.fl('Text') + ',9')
		select('Table', 'cell:' + commonBits.fl('Data') + ',9(LADIES KNw)')
		assert_p('Table', 'Text', 'LADIES KNw', commonBits.fl('Data') + ',9')
		select('Table', 'cell:' + commonBits.fl('Data') + ',10(C)')
		assert_p('Table', 'Content', '[[Vendor, 8, 10, 5110, 0000005110], [PO, 18, 12, 211985, 000000211985], [Entry Date, 30, 6, 040929, 040929], [Department, 48, 4, 200, 200], [Expected Reciept Date, 52, 6, 050103, 050103], [Cancel by date, 58, 6, 050107, 050107], [EDI Type, 68, 1, , ], [Add Date, 69, 6, , ], [Filler, 75, 1, , ], [Department Name, 76, 10, LADIES KNw, LADIES KNw], [Prcoess Type, 86, 1, C, C], [Order Type, 87, 2, FT, FT]]')
	close()
