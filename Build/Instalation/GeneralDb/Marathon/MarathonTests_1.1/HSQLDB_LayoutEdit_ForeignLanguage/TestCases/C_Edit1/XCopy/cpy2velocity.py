useFixture(RecordEditor)

def test():
	from Modules import commonBits
	java_recorded_version = '1.6.0_10'

	if window('Record Editor'):
		commonBits.selectOldFilemenu(select_menu, 'Utilities', 'File Copy Menu')
		click('*5')
		select('FileChooser', commonBits.sampleDir() + 'DTAR020.bin')
		select('FileChooser1', commonBits.sampleDir() + 'csvDTAR020comma.csv')
		commonBits.setRecordLayout2(select, 'DTAR020')

		if commonBits.isJRecord():
			select('FileChooser3', commonBits.velocityDir() + 'toCsv_Comma.vm')
		else:
			select('FileChooser2', commonBits.velocityDir() + 'toCsv_Comma.vm')
		click('Right')
		select('TabbedPane', '')
		##click('Copy2')
		commonBits.copy(click)
		rightclick('TextField')
		assert_p('TextField1', 'Text', commonBits.fl('Copy Done !!!')
)
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		click('Open')
		click('Open')
		select('FileChooser', commonBits.sampleDir() + 'csvDTAR020comma.csv')
		commonBits.doEdit(click)


		if window(''):
			select('CheckBox', 'true')
			click(commonBits.fl('Go'))
			commonBits.doSleep()
		close()

		commonBits.doSleep()

#		select('Table', 'rows:[1,2,3,4,5,6,7,8,9,10,11],columns:[1|KEYCODE-NO,2|STORE-NO]')
		select('Table', 'rows:[1,2,3,4,5,6,7,8,9,10,11],columns:[1|KEYCODE-NO,2|STORE-NO]')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
##		select('Table2', 'rows:[1,2,3,4,5,6,7,8,9,10,11],columns:[1|KEYCODE-NO,2|STORE-NO]')
		select('Table', 'cell:1|KEYCODE-NO,3(69694158)')
##		assert_p('Table', 'Content', '[[69684558, 20, 40118, 280, -1, -19.00], [69684558, 20, 40118, 280, 1, 5.01], [69694158, 20, 40118, 280, 1, 19.00], [69694158, 20, 40118, 280, -1, -19.00], [69694158, 20, 40118, 280, 1, 5.01], [63604808, 20, 40118, 170, 1, 4.87], [62684671, 20, 40118, 685, 1, 69.99], [62684671, 20, 40118, 685, -1, -69.99], [64634429, 20, 40118, 957, 1, 3.99], [66624458, 20, 40118, 957, 1, 0.89], [63674861, 20, 40118, 957, 10, 2.70]]')
		assert_p('Table', 'Content', '[[69684558, 20, 40118, 280, 1, 5.01], [69694158, 20, 40118, 280, 1, 19.00], [69694158, 20, 40118, 280, -1, -19.00], [69694158, 20, 40118, 280, 1, 5.01], [63604808, 20, 40118, 170, 1, 4.87], [62684671, 20, 40118, 685, 1, 69.99], [62684671, 20, 40118, 685, -1, -69.99], [64634429, 20, 40118, 957, 1, 3.99], [66624458, 20, 40118, 957, 1, 0.89], [63674861, 20, 40118, 957, 10, 2.70]]')
		select('Table', 'cell:1|KEYCODE-NO,3(69694158)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
##		select('Table', 'rows:[1,2,3,4,5,6,7,8,9,10,11],columns:[1|KEYCODE-NO,2|STORE-NO]')
##		select('Table', 'rows:[1,2,3,4,5,6,7,8,9,10,11],columns:[1|KEYCODE-NO,2|STORE-NO]')
		select_menu(commonBits.fl('Window') + '>>csvDTAR020comma.csv>>' + commonBits.fl('Table:'))
		select('Table', 'rows:[20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],columns:[1|KEYCODE-NO]')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
##		select('Table2', 'rows:[20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],columns:[1|KEYCODE-NO]')
		select('Table', 'cell:2|STORE-NO,5(59)')
		assert_p('Table', 'Content', '[[60694698, 59, 40118, 620, 1, 3.99], [60664659, 59, 40118, 620, 1, 3.99], [62684217, 59, 40118, 957, 1, 9.99], [67674686, 59, 40118, 929, 1, 3.99], [61684613, 59, 40118, 335, 1, 12.99], [64624770, 59, 40118, 957, 1, 2.59], [69694814, 166, 40118, 360, 1, 2.50], [69694814, 166, 40118, 360, 1, 2.50], [69644164, 166, 40118, 193, 1, 21.59], [62684907, 166, 40118, 375, 1, 13.99], [62694193, 166, 40118, 375, 1, 13.99], [62694193, 166, 40118, 375, -1, -13.99], [62694193, 166, 40118, 375, 1, 11.99], [63654450, 166, 40118, 320, 1, 13.99], [62664576, 166, 40118, 320, 1, 9.72]]')
		select('Table', 'cell:2|STORE-NO,5(59)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
##		select('Table', 'rows:[20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],columns:[1|KEYCODE-NO]')
##		select('Table', 'rows:[20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],columns:[1|KEYCODE-NO]')
		select_menu(commonBits.fl('Window') + '>>csvDTAR020comma.csv>>' + commonBits.fl('Table:'))
		select('Table', 'cell:2|STORE-NO,38(166)')
		rightclick('Table', '2|STORE-NO,38')
		select_menu( commonBits.fl('Edit Record'))
##		select('Table1', 'cell:2|STORE-NO,38(166)')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		assert_p('Table', 'Content', '[[KEYCODE-NO, 1, , 64674965, 64674965], [STORE-NO, 2, , 166, 166], [DATE, 3, , 40118, 40118], [DEPT-NO, 4, , 235, 235], [QTY-SOLD, 5, , -1, -1], [SALE-PRICE, 6, , -19.99, -19.99]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		click('TextArea')
		assert_p('TextArea', 'Text', '64674965,166,40118,235,-1,-19.99,')
		click('Right')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		assert_p('Table', 'Content', '[[KEYCODE-NO, 1, , 64674965, 64674965], [STORE-NO, 2, , 166, 166], [DATE, 3, , 40118, 40118], [DEPT-NO, 4, , 235, 235], [QTY-SOLD, 5, , 1, 1], [SALE-PRICE, 6, , 12.00, 12.00]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		click('TextArea')
		assert_p('TextArea', 'Text', '64674965,166,40118,235,1,12.00,')
		click('Right')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		assert_p('Table', 'Content', '[[KEYCODE-NO, 1, , 60624523, 60624523], [STORE-NO, 2, , 166, 166], [DATE, 3, , 40118, 40118], [DEPT-NO, 4, , 261, 261], [QTY-SOLD, 5, , 1, 1], [SALE-PRICE, 6, , 12.00, 12.00]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		click('TextArea')
		assert_p('TextArea', 'Text', '60624523,166,40118,261,1,12.00,')
		click('Right')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		assert_p('Table', 'Content', '[[KEYCODE-NO, 1, , 66624253, 66624253], [STORE-NO, 2, , 166, 166], [DATE, 3, , 40118, 40118], [DEPT-NO, 4, , 957, 957], [QTY-SOLD, 5, , 1, 1], [SALE-PRICE, 6, , 3.49, 3.49]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		click('TextArea')
		click('TextArea')
		assert_p('TextArea', 'Text', '66624253,166,40118,957,1,3.49,')
		click('Right')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		assert_p('Table', 'Content', '[[KEYCODE-NO, 1, , 66624253, 66624253], [STORE-NO, 2, , 166, 166], [DATE, 3, , 40118, 40118], [DEPT-NO, 4, , 957, 957], [QTY-SOLD, 5, , 1, 1], [SALE-PRICE, 6, , 3.49, 3.49]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		click('TextArea')
		assert_p('TextArea', 'Text', '66624253,166,40118,957,1,3.49,')
		click('Right')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		assert_p('Table', 'Content', '[[KEYCODE-NO, 1, , 64654284, 64654284], [STORE-NO, 2, , 166, 166], [DATE, 3, , 40118, 40118], [DEPT-NO, 4, , 957, 957], [QTY-SOLD, 5, , 1, 1], [SALE-PRICE, 6, , 3.99, 3.99]]')
		select('Table', 'cell:' + commonBits.fl('Data') + ',2(40118)')
		click('TextArea')
		assert_p('TextArea', 'Text', '64654284,166,40118,957,1,3.99,')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('Table', 'cell:2|STORE-NO,38(166)')
		select('Table', 'cell:2|STORE-NO,38(166)')
		select_menu(commonBits.fl('Window') + '>>csvDTAR020comma.csv>>' + commonBits.fl('Table:'))
		select('Table', 'cell:2|STORE-NO,38(166)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		commonBits.selectOldFilemenu(select_menu, 'Utilities', 'Compare Menu')
		click('*2')
		select('FileChooser', commonBits.sampleDir() + 'csvDTAR020comma.csv')
		click('Right')

		if window(''):
			select('CheckBox', 'true')
			click(commonBits.fl('Go'))
		close()

		select('TabbedPane', '')
		select('FileChooser', commonBits.sampleDir() + 'DTAR020.bin')
		click('Right')
		select('TabbedPane', '')
		select('Table', 'cell:' + commonBits.fl('Equivalent Record') + ',0(-1)')
		select('Table', 'DTAR020', commonBits.fl('Equivalent Record') + ',0')
		select('Table', 'cell:' + commonBits.fl('Equivalent Record') + ',0(0)')
		select('Table1', 'cell:' + commonBits.fl('Field') + ',2(DATE)')
		assert_p('Table1', 'Content', '[[KEYCODE-NO, KEYCODE-NO], [STORE-NO, STORE-NO], [DATE, DATE], [DEPT-NO, DEPT-NO], [QTY-SOLD, QTY-SOLD], [SALE-PRICE, SALE-PRICE]]')
##		select('Table1', '')
		select('Table', 'cell:' + commonBits.fl('Record') + ',0(GeneratedCsvRecord)')
		assert_p('Table', 'Content', '[[GeneratedCsvRecord, DTAR020]]')
		select('Table', 'cell:' + commonBits.fl('Record') + ',0(GeneratedCsvRecord)')
		click('Right')
		select('TabbedPane', '')
		click(commonBits.fl('Compare'))
		assert_p('TextPane', 'Text', 'Files are Identical !!!')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
	close()
