useFixture(default)

def test():
	from Modules import commonBits
	import time

	java_recorded_version = '1.6.0_03'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'utf8a_Ams_PODownload_20041231.txt')
		commonBits.setRecordLayout(select, 'utf8_ams PO Download')
		commonBits.doEdit(click)
		select_menu('View>>Record Based Tree')
		select('Table', 'ams PO Download: Header', 'Parent Record,0')
		select('Table', 'ams PO Download: Detail', 'Parent Record,2')
#		select('Table', '1', 'Parent Record,0')
#		select('Table', '0', 'Parent Record,2')
		select('Table', 'cell:Parent Record,2(0)')
		click('Build')
		select('JTreeTable', 'cell:PO,1(222227)')
		assert_p('JTreeTable', 'Text', '222227', 'PO,1')
		select('JTreeTable', 'cell:PO,1(222227)')
		select_menu('File>>Save Tree as XML')
		select('JTreeTable', 'cell:PO,1(222227)')

		if window('Open'):
##			select(commonBits.selectPane(), 'x1utf8a_Ams_PODownload_20041231.txt.xml')
			select('File Name', 'x1utf8a_Ams_PODownload_20041231.txt.xml')
			click('Open')
		close()

		select('JTreeTable', 'cell:PO,1(222227)')
		click('Open')
		select('FileChooser', commonBits.sampleDir() + 'x1utf8a_Ams_PODownload_20041231.txt.xml')
		commonBits.doEdit(click)


		select('JTreeTable', 'cell:Xml~Prefix,1(null)')
		rightclick('JTreeTable', 'Xml~Prefix,1')
		select_menu('Expand Tree')
		select('LayoutCombo', 'ams_PO_Download__Header')
		select('JTreeTable', 'cell:Department_Name,2(LADIES KNI)')
		assert_p('JTreeTable', 'Text', 'LADIES KNI', 'Department_Name,2')
		select('JTreeTable', 'cell:Cancel_by_date,2(050107)')
		assert_p('JTreeTable', 'Text', '050107', 'Cancel_by_date,2')
		select('JTreeTable', 'cell:Vendor,2(6060)')
		rightclick('JTreeTable', 'Vendor,2')
		select_menu('Edit Record')
		select('JTreeTable', 'cell:Vendor,2(6060)')
		select('Table', 'cell:Data,6(286225)')
		assert_p('Table', 'Text', '040909', 'Data,7')
		select('Table', 'cell:Data,7(040909)')
		assert_p('Table', 'Content', '[[Xml~Name, 0, , ams_PO_Download__Header, ams_PO_Download__Header], [Xml~Prefix, 3, , , ], [Xml~Namespace, 4, , , ], [Record_Type, 5, , H1, H1], [Sequence_Number, 6, , 45.349, 45.349], [Vendor, 7, , 6060, 6060], [PO, 8, , 286225, 286225], [Entry_Date, 9, , 040909, 040909], [beg01_code, 10, , 00, 00], [Department, 11, , 200, 200], [Expected_Reciept_Date, 12, , 050102, 050102], [Cancel_by_date, 13, , 050107, 050107], [Department_Name, 14, , LADIES KNI, LADIES KNI], [Prcoess_Type, 15, , C, C], [Order_Type, 16, , FT, FT], [EDI_Type, 17, , , ], [Xml~End, 1, , , ], [Following~Text, 2, , , ]]')
		click('Right')
		select('Table', 'cell:Data,6(2222500000000)')
		select('Table', 'cell:Data,6(2222500000000)')
		assert_p('Table', 'Content', '[[Xml~Name, 0, , ams_PO_Download__Detail, ams_PO_Download__Detail], [Xml~Prefix, 3, , , ], [Xml~Namespace, 4, , , ], [Record_Type, 5, , D1, D1], [Pack_Qty, 6, , 7.0000, 7.0000], [Pack_Cost, 7, , 0.0002, 0.0002], [APN, 8, , 2222500000000, 2222500000000], [Product, 9, , 43314531, 43314531], [pmg_dtl_tech_key, 10, , 2075359, 2075359], [Case_Pack_id, 11, , 45614531, 45614531], [Product_Name, 12, ,  DONKEY 24-006607 SHWL WRAP CARD,  DONKEY 24-006607 SHWL WRAP CARD], [Xml~End, 1, , , ], [Following~Text, 2, , , ]]')
		select('Table', 'cell:Data,6(2222500000000)')
		click('Right')
		select('Table', 'cell:Data,8(5076)')
		select('Table', 'cell:Data,8(5076)')
		assert_p('Table', 'Content', '[[Xml~Name, 0, , ams_PO_Download__Allocation, ams_PO_Download__Allocation], [Xml~Prefix, 3, , , ], [Xml~Namespace, 4, , , ], [Record_Type, 5, , S1, S1], [DC_Number_1, 6, , 5043, 5043], [Pack_Quantity_1, 7, , 1, 1], [DC_Number_2, 8, , 5045, 5045], [Pack_Quantity_2, 9, , 1, 1], [DC_Number_4, 10, , 5076, 5076], [Pack_Quantity_4, 11, , 1, 1], [DC_Number_5, 12, , 5079, 5079], [Pack_Quantity_5, 13, , 1, 1], [DC_Number_6, 14, , 5151, 5151], [Pack_Quantity_6, 15, , 1, 1], [DC_Number_7, 16, , 5072, 5072], [Pack_Quantity_7, 17, , 1, 1], [Pack_Quantity_8, 18, , 0, 0], [Pack_Quantity_9, 19, , 0, 0], [Pack_Quantity_10, 20, , 0, 0], [DC_Number_8, 21, , , ], [DC_Number_9, 22, , , ], [DC_Number_10, 23, , , ], [Xml~End, 1, , True, True], [Following~Text, 2, , , ]]')
		select('Table', 'cell:Data,10(5079)')
		assert_p('Table', 'Text', '5079', 'Data,10')
		click('Right')
##		select('Table', '')
		assert_p('Table', 'Content', '[[Xml~Name, 0, , /ams_PO_Download__Detail, /ams_PO_Download__Detail], [Xml~End, 1, , , ], [Following~Text, 2, , , ]]')
		select('Table', 'cell:Text,1()')
		click('Right')
		select('Table', 'cell:Data,10( MILK 24-006607 SHWL WRAP CARD)')
		select('Table', 'cell:Data,10( MILK 24-006607 SHWL WRAP CARD)')
		assert_p('Table', 'Text', ' MILK 24-006607 SHWL WRAP CARD', 'Data,10')
		select('Table', 'cell:Data,7(5614944)')
		assert_p('Table', 'Text', '5614944', 'Data,7')
		select('Table', 'cell:Data,8(2075360)')
		select('Table', 'cell:Data,8(2075360)')
		assert_p('Table', 'Content', '[[Xml~Name, 0, , ams_PO_Download__Detail, ams_PO_Download__Detail], [Xml~Prefix, 3, , , ], [Xml~Namespace, 4, , , ], [Record_Type, 5, , D1, D1], [Pack_Qty, 6, , 4.0000, 4.0000], [Pack_Cost, 7, , 148.3200, 148.3200], [APN, 8, , 0, 0], [Product, 9, , 5614944, 5614944], [pmg_dtl_tech_key, 10, , 2075360, 2075360], [Case_Pack_id, 11, , 5614944, 5614944], [Product_Name, 12, ,  MILK 24-006607 SHWL WRAP CARD,  MILK 24-006607 SHWL WRAP CARD], [Xml~End, 1, , , ], [Following~Text, 2, , , ]]')

##		if window(r'Save Changes to file: C:\Program Files\RecordEdit\HSQLDB\SampleFiles\x1utf8a_Ams_PODownload_20041231.txt.xml'):
##			click('No')
##			click('No')
##		close()
	close()
