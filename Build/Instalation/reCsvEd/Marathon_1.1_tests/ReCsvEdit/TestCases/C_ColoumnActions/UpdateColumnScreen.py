useFixture(default)

def test():
	java_recorded_version = '1.6.0_22'

	if window('reCsv Editor'):
		select('FilePane$3', 'XfdDTAR020.csv')
		doubleclick('FilePane$3', '6')
		click('Edit1')
		select_menu('Edit>>Update Csv Columns')
		select('FieldChange_JTbl', 'false', 'Include,2')
		select('FieldChange_JTbl', 'cell:Include,2(false)')
		rightclick('FieldChange_JTbl', 'Decimal Places,3')
		select_menu('Move ...>>After  SALE-PRICE')
		select('FieldChange_JTbl', 'cell:Decimal Places,3(null)')
		rightclick('FieldChange_JTbl', 'Decimal Places,3')
		select_menu('Add Field After')
		select('FieldChange_JTbl', 'new', 'Field Name,4')
		select('FieldChange_JTbl', 'STORE-NO', 'Source Column,4')
		select('FieldChange_JTbl', 'cell:Decimal Places,6(null)')
		rightclick('FieldChange_JTbl', 'Decimal Places,6')
		select_menu('Add Field After')
		select('FieldChange_JTbl', 'false', 'Include,2')
		select('FieldChange_JTbl', 'qty1', 'Field Name,7')
		select('FieldChange_JTbl', 'QTY-SOLD', 'Source Column,7')
		select('FieldChange_JTbl', 'cell:Decimal Places,6(null)')
		click('Apply')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[69684558, 20, 1, 20, 5.01, 280, 1], [69694158, 20, 1, 20, 19.00, 280, 1], [69694158, 20, -1, 20, -19.00, 280, -1], [69694158, 20, 1, 20, 5.01, 280, 1], [63604808, 20, 1, 20, 4.87, 170, 1], [62684671, 20, 1, 20, 69.99, 685, 1], [62684671, 20, -1, 20, -69.99, 685, -1], [64634429, 20, 1, 20, 3.99, 957, 1], [66624458, 20, 1, 20, 0.89, 957, 1], [63674861, 20, 10, 20, 2.70, 957, 10], [65674532, 20, 1, 20, 3.59, 929, 1], [64614401, 59, 1, 59, 1.99, 957, 1], [64614401, 59, 1, 59, 1.99, 957, 1], [61664713, 59, 1, 59, 17.99, 335, 1], [61664713, 59, -1, 59, -17.99, 335, -1], [68634752, 59, 1, 59, 8.99, 410, 1], [60614487, 59, 1, 59, 5.95, 878, 1], [63644339, 59, 1, 59, 12.65, 878, 1], [60694698, 59, 1, 59, 3.99, 620, 1], [60664659, 59, 1, 59, 3.99, 620, 1], [62684217, 59, 1, 59, 9.99, 957, 1], [67674686, 59, 1, 59, 3.99, 929, 1]]')
		select('LineList.Layouts_Txt', 'Full Line')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[69684558;20;1;20;5.01;280;1], [69694158;20;1;20;19.00;280;1], [69694158;20;-1;20;-19.00;280;-1], [69694158;20;1;20;5.01;280;1], [63604808;20;1;20;4.87;170;1], [62684671;20;1;20;69.99;685;1], [62684671;20;-1;20;-69.99;685;-1], [64634429;20;1;20;3.99;957;1], [66624458;20;1;20;0.89;957;1], [63674861;20;10;20;2.70;957;10], [65674532;20;1;20;3.59;929;1], [64614401;59;1;59;1.99;957;1], [64614401;59;1;59;1.99;957;1], [61664713;59;1;59;17.99;335;1], [61664713;59;-1;59;-17.99;335;-1], [68634752;59;1;59;8.99;410;1], [60614487;59;1;59;5.95;878;1], [63644339;59;1;59;12.65;878;1], [60694698;59;1;59;3.99;620;1], [60664659;59;1;59;3.99;620;1], [62684217;59;1;59;9.99;957;1], [67674686;59;1;59;3.99;929;1]]')
##		select('LineList.FileDisplay_JTbl', 'cell:Full Line,5(62684671;20;1;20;69.99;685;1)')

		select('LineList.Layouts_Txt', 'GeneratedCsvRecord')
		select_menu('Edit>>Update Csv Columns')
		select('FieldChange_JTbl', 'false', 'Include,6')
#		select('FieldChange_JTbl', 'cell:Include,6(false)')
		select('Field Delimiter_Txt', '|')
		click('Apply')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[69684558, 20, 1, 20, 5.01, 280], [69694158, 20, 1, 20, 19.00, 280], [69694158, 20, -1, 20, -19.00, 280], [69694158, 20, 1, 20, 5.01, 280], [63604808, 20, 1, 20, 4.87, 170], [62684671, 20, 1, 20, 69.99, 685], [62684671, 20, -1, 20, -69.99, 685], [64634429, 20, 1, 20, 3.99, 957], [66624458, 20, 1, 20, 0.89, 957], [63674861, 20, 10, 20, 2.70, 957], [65674532, 20, 1, 20, 3.59, 929], [64614401, 59, 1, 59, 1.99, 957], [64614401, 59, 1, 59, 1.99, 957], [61664713, 59, 1, 59, 17.99, 335], [61664713, 59, -1, 59, -17.99, 335], [68634752, 59, 1, 59, 8.99, 410], [60614487, 59, 1, 59, 5.95, 878], [63644339, 59, 1, 59, 12.65, 878], [60694698, 59, 1, 59, 3.99, 620], [60664659, 59, 1, 59, 3.99, 620], [62684217, 59, 1, 59, 9.99, 957], [67674686, 59, 1, 59, 3.99, 929]]')
		select('LineList.Layouts_Txt', 'Full Line')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[69684558|20|1|20|5.01|280], [69694158|20|1|20|19.00|280], [69694158|20|-1|20|-19.00|280], [69694158|20|1|20|5.01|280], [63604808|20|1|20|4.87|170], [62684671|20|1|20|69.99|685], [62684671|20|-1|20|-69.99|685], [64634429|20|1|20|3.99|957], [66624458|20|1|20|0.89|957], [63674861|20|10|20|2.70|957], [65674532|20|1|20|3.59|929], [64614401|59|1|59|1.99|957], [64614401|59|1|59|1.99|957], [61664713|59|1|59|17.99|335], [61664713|59|-1|59|-17.99|335], [68634752|59|1|59|8.99|410], [60614487|59|1|59|5.95|878], [63644339|59|1|59|12.65|878], [60694698|59|1|59|3.99|620], [60664659|59|1|59|3.99|620], [62684217|59|1|59|9.99|957], [67674686|59|1|59|3.99|929]]')
		select('LineList.FileDisplay_JTbl', 'cell:Full Line,5(62684671|20|1|20|69.99|685)')
		click('BasicInternalFrameTitlePane$NoFocusButton2')

		if window(r'Save Changes to file: C:\Users\BruceTst2\.RecordEditor\reCsvEd\SampleFiles\XfdDTAR020.csv.csv'):
			click('No')
		close()
	close()
