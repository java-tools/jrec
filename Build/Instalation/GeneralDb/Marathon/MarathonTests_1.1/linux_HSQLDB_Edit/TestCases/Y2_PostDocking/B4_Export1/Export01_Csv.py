useFixture(default)

def test():
	from Modules import commonBits
	java_recorded_version = '1.6.0_22'

	if window('Record Editor'):
		select('File_Txt', commonBits.sampleDir() + 'DTAR020_tst1.bin')
		click('Edit1')
		select_menu('File>>Export as CSV file')
		select('Edit Output File_Chk', 'true')
		select('Keep screen open_Chk', 'true')
		select('File Name_Txt', commonBits.sampleDir() + 'zcsv_DTAR020_tst1.bin.csv')
		click('Save File')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808, 20, 40118, 170, 1, 4.87], [69684558, 20, 40118, 280, 1, 19.00], [69684558, 20, 40118, 280, -1, -19.00], [69694158, 20, 40118, 280, 1, 5.01], [62684671, 20, 40118, 685, 1, 69.99], [62684671, 20, 40118, 685, -1, -69.99], [61664713, 59, 40118, 335, 1, 17.99], [61664713, 59, 40118, 335, -1, -17.99], [61684613, 59, 40118, 335, 1, 12.99], [68634752, 59, 40118, 410, 1, 8.99], [60694698, 59, 40118, 620, 1, 3.99], [60664659, 59, 40118, 620, 1, 3.99], [60614487, 59, 40118, 878, 1, 5.95], [68654655, 166, 40118, 60, 1, 5.08], [69624033, 166, 40118, 80, 1, 18.19], [60604100, 166, 40118, 80, 1, 13.30], [68674560, 166, 40118, 170, 1, 5.99]]')
		select('LineList.Layouts_Txt', 'Full Line')
##		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808204011817014.87], [696845582040118280119.00], [696845582040118280-1-19.00], [69694158204011828015.01], [626846712040118685169.99], [626846712040118685-1-69.99], [616647135940118335117.99], [616647135940118335-1-17.99], [616846135940118335112.99], [68634752594011841018.99], [60694698594011862013.99], [60664659594011862013.99], [60614487594011887815.95], [68654655166401186015.08], [696240331664011880118.19], [606041001664011880113.30], [686745601664011817015.99]]')

		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808	20	40118	170	1	4.87], [69684558	20	40118	280	1	19.00], [69684558	20	40118	280	-1	-19.00], [69694158	20	40118	280	1	5.01], [62684671	20	40118	685	1	69.99], [62684671	20	40118	685	-1	-69.99], [61664713	59	40118	335	1	17.99], [61664713	59	40118	335	-1	-17.99], [61684613	59	40118	335	1	12.99], [68634752	59	40118	410	1	8.99], [60694698	59	40118	620	1	3.99], [60664659	59	40118	620	1	3.99], [60614487	59	40118	878	1	5.95], [68654655	166	40118	60	1	5.08], [69624033	166	40118	80	1	18.19], [60604100	166	40118	80	1	13.30], [68674560	166	40118	170	1	5.99]]')

		click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('CsvColNames_JTbl', 'cell:Include,2(true)')

		click('Save File')

		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808, 20, 170, 1, 4.87], [69684558, 20, 280, 1, 19.00], [69684558, 20, 280, -1, -19.00], [69694158, 20, 280, 1, 5.01], [62684671, 20, 685, 1, 69.99], [62684671, 20, 685, -1, -69.99], [61664713, 59, 335, 1, 17.99], [61664713, 59, 335, -1, -17.99], [61684613, 59, 335, 1, 12.99], [68634752, 59, 410, 1, 8.99], [60694698, 59, 620, 1, 3.99], [60664659, 59, 620, 1, 3.99], [60614487, 59, 878, 1, 5.95], [68654655, 166, 60, 1, 5.08], [69624033, 166, 80, 1, 18.19], [60604100, 166, 80, 1, 13.30], [68674560, 166, 170, 1, 5.99]]')
		select('LineList.Layouts_Txt', 'Full Line')
##		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[636048082017014.87], [6968455820280119.00], [6968455820280-1-19.00], [696941582028015.01], [6268467120685169.99], [6268467120685-1-69.99], [6166471359335117.99], [6166471359335-1-17.99], [6168461359335112.99], [686347525941018.99], [606946985962013.99], [606646595962013.99], [606144875987815.95], [686546551666015.08], [6962403316680118.19], [6060410016680113.30], [6867456016617015.99]]')

		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808	20	170	1	4.87], [69684558	20	280	1	19.00], [69684558	20	280	-1	-19.00], [69694158	20	280	1	5.01], [62684671	20	685	1	69.99], [62684671	20	685	-1	-69.99], [61664713	59	335	1	17.99], [61664713	59	335	-1	-17.99], [61684613	59	335	1	12.99], [68634752	59	410	1	8.99], [60694698	59	620	1	3.99], [60664659	59	620	1	3.99], [60614487	59	878	1	5.95], [68654655	166	60	1	5.08], [69624033	166	80	1	18.19], [60604100	166	80	1	13.30], [68674560	166	170	1	5.99]]')

		click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('Csv.Delimiter_Txt', ',')
		click('Save File')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808, 20, 170, 1, 4.87], [69684558, 20, 280, 1, 19.00], [69684558, 20, 280, -1, -19.00], [69694158, 20, 280, 1, 5.01], [62684671, 20, 685, 1, 69.99], [62684671, 20, 685, -1, -69.99], [61664713, 59, 335, 1, 17.99], [61664713, 59, 335, -1, -17.99], [61684613, 59, 335, 1, 12.99], [68634752, 59, 410, 1, 8.99], [60694698, 59, 620, 1, 3.99], [60664659, 59, 620, 1, 3.99], [60614487, 59, 878, 1, 5.95], [68654655, 166, 60, 1, 5.08], [69624033, 166, 80, 1, 18.19], [60604100, 166, 80, 1, 13.30], [68674560, 166, 170, 1, 5.99]]')
		select('LineList.Layouts_Txt', 'Full Line')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808,20,170,1,4.87], [69684558,20,280,1,19.00], [69684558,20,280,-1,-19.00], [69694158,20,280,1,5.01], [62684671,20,685,1,69.99], [62684671,20,685,-1,-69.99], [61664713,59,335,1,17.99], [61664713,59,335,-1,-17.99], [61684613,59,335,1,12.99], [68634752,59,410,1,8.99], [60694698,59,620,1,3.99], [60664659,59,620,1,3.99], [60614487,59,878,1,5.95], [68654655,166,60,1,5.08], [69624033,166,80,1,18.19], [60604100,166,80,1,13.30], [68674560,166,170,1,5.99]]')
		select_menu('View>>Text View')
		select('TabbedPane', 'Document View')
		assert_p('TextArea', 'Text', '''63604808,20,170,1,4.87
69684558,20,280,1,19.00
69684558,20,280,-1,-19.00
69694158,20,280,1,5.01
62684671,20,685,1,69.99
62684671,20,685,-1,-69.99
61664713,59,335,1,17.99
61664713,59,335,-1,-17.99
61684613,59,335,1,12.99
68634752,59,410,1,8.99
60694698,59,620,1,3.99
60664659,59,620,1,3.99
60614487,59,878,1,5.95
68654655,166,60,1,5.08
69624033,166,80,1,18.19
60604100,166,80,1,13.30
68674560,166,170,1,5.99''')
		click('X1')
##		select('TabbedPane', 'Table:')

		click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('Csv.Delimiter_Txt', ';')
		click('Save File')

		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808, 20, 170, 1, 4.87], [69684558, 20, 280, 1, 19.00], [69684558, 20, 280, -1, -19.00], [69694158, 20, 280, 1, 5.01], [62684671, 20, 685, 1, 69.99], [62684671, 20, 685, -1, -69.99], [61664713, 59, 335, 1, 17.99], [61664713, 59, 335, -1, -17.99], [61684613, 59, 335, 1, 12.99], [68634752, 59, 410, 1, 8.99], [60694698, 59, 620, 1, 3.99], [60664659, 59, 620, 1, 3.99], [60614487, 59, 878, 1, 5.95], [68654655, 166, 60, 1, 5.08], [69624033, 166, 80, 1, 18.19], [60604100, 166, 80, 1, 13.30], [68674560, 166, 170, 1, 5.99]]')
		select('LineList.Layouts_Txt', 'Full Line')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808;20;170;1;4.87], [69684558;20;280;1;19.00], [69684558;20;280;-1;-19.00], [69694158;20;280;1;5.01], [62684671;20;685;1;69.99], [62684671;20;685;-1;-69.99], [61664713;59;335;1;17.99], [61664713;59;335;-1;-17.99], [61684613;59;335;1;12.99], [68634752;59;410;1;8.99], [60694698;59;620;1;3.99], [60664659;59;620;1;3.99], [60614487;59;878;1;5.95], [68654655;166;60;1;5.08], [69624033;166;80;1;18.19], [60604100;166;80;1;13.30], [68674560;166;170;1;5.99]]')
		select_menu('View>>Text View')
		select('TabbedPane', 'Document View')
		assert_p('TextArea', 'Text', '''63604808;20;170;1;4.87
69684558;20;280;1;19.00
69684558;20;280;-1;-19.00
69694158;20;280;1;5.01
62684671;20;685;1;69.99
62684671;20;685;-1;-69.99
61664713;59;335;1;17.99
61664713;59;335;-1;-17.99
61684613;59;335;1;12.99
68634752;59;410;1;8.99
60694698;59;620;1;3.99
60664659;59;620;1;3.99
60614487;59;878;1;5.95
68654655;166;60;1;5.08
69624033;166;80;1;18.19
60604100;166;80;1;13.30
68674560;166;170;1;5.99''')


		click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('CsvColNames_JTbl', 'cell:Include,4(true)')

		click('Save File')

##		select('TabbedPane', 'Table:')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808, 20, 170, 4.87], [69684558, 20, 280, 19.00], [69684558, 20, 280, -19.00], [69694158, 20, 280, 5.01], [62684671, 20, 685, 69.99], [62684671, 20, 685, -69.99], [61664713, 59, 335, 17.99], [61664713, 59, 335, -17.99], [61684613, 59, 335, 12.99], [68634752, 59, 410, 8.99], [60694698, 59, 620, 3.99], [60664659, 59, 620, 3.99], [60614487, 59, 878, 5.95], [68654655, 166, 60, 5.08], [69624033, 166, 80, 18.19], [60604100, 166, 80, 13.30], [68674560, 166, 170, 5.99]]')
		select('LineList.Layouts_Txt', 'Full Line')
		assert_p('LineList.FileDisplay_JTbl', 'Content', '[[63604808;20;170;4.87], [69684558;20;280;19.00], [69684558;20;280;-19.00], [69694158;20;280;5.01], [62684671;20;685;69.99], [62684671;20;685;-69.99], [61664713;59;335;17.99], [61664713;59;335;-17.99], [61684613;59;335;12.99], [68634752;59;410;8.99], [60694698;59;620;3.99], [60664659;59;620;3.99], [60614487;59;878;5.95], [68654655;166;60;5.08], [69624033;166;80;18.19], [60604100;166;80;13.30], [68674560;166;170;5.99]]')
	close()
