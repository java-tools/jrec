useFixture(default)

def test():
	from Modules import commonBits
	java_recorded_version = '1.6.0_03'

	if window('Record Editor'):
##		select('FileChooser', '/C:/Program Files/RecordEdit/HSQLDB/SampleFiles/DTAR020.bin')
		select('FileChooser', commonBits.sampleDir() + 'DTAR020.bin')
		commonBits.setRecordLayout(select, 'DTAR020')
		click('Edit1')
		click('SaveAs1')
		select('ComboBox1', 'XML')
##		select('FileChooser', '/C:/Program Files/RecordEdit/HSQLDB/SampleFiles/x1DTAR020.bin.xml')
		select('FileChooser', commonBits.sampleDir() + 'x1DTAR020.bin.xml')
		click('save file')
		click('Open')
##		select('FileChooser', '/C:/Program Files/RecordEdit/HSQLDB/SampleFiles/x1DTAR020.bin.xml')
		select('FileChooser', commonBits.sampleDir() + 'x1DTAR020.bin.xml')
		click('Edit1')
		select('JTreeTable', 'cell:Tree,1(null)')
		rightclick('JTreeTable', 'Tree,1')
		select_menu('Expand Tree')

##		select('JTreeTable', 'cell:Xml~Prefix,3(null)')
		assert_p('JTreeTable', 'RowCount', '381')
		select('JTreeTable', 'cell:Xml~Prefix,2(null)')
		rightclick('JTreeTable', 'Xml~Prefix,2')
		select_menu('Edit Record')
		##select('JTreeTable', 'cell:Xml~Prefix,2(null)')
		select('Table', 'cell:Data,3(69684558)')
		assert_p('Table', 'Text', '40118', 'Data,5')
		select('Table', 'cell:Data,5(40118)')
		assert_p('Table', 'Content', '[[Xml~Name, 0, , DTAR020, DTAR020], [Xml~Prefix, 3, , , ], [Xml~Namespace, 4, , , ], [KEYCODE-NO, 5, , 69684558, 69684558], [STORE-NO, 6, , 20, 20], [DATE, 7, , 40118, 40118], [DEPT-NO, 8, , 280, 280], [QTY-SOLD, 9, , 1, 1], [SALE-PRICE, 10, , 19.00, 19.00], [Xml~End, 1, , True, True], [Following~Text, 2, , , ]]')
		click('Right')
		select('Table', 'cell:Data,5(40118)')
		select('Table', 'cell:Data,5(40118)')
		assert_p('Table', 'Content', '[[Xml~Name, 0, , DTAR020, DTAR020], [Xml~Prefix, 3, , , ], [Xml~Namespace, 4, , , ], [KEYCODE-NO, 5, , 69684558, 69684558], [STORE-NO, 6, , 20, 20], [DATE, 7, , 40118, 40118], [DEPT-NO, 8, , 280, 280], [QTY-SOLD, 9, , -1, -1], [SALE-PRICE, 10, , -19.00, -19.00], [Xml~End, 1, , True, True], [Following~Text, 2, , , ]]')
		select('Table', 'cell:Data,5(40118)')
		click('Right')
		select('Table', 'cell:Data,6(280)')
		select('Table', 'cell:Data,6(280)')
		assert_p('Table', 'Content', '[[Xml~Name, 0, , DTAR020, DTAR020], [Xml~Prefix, 3, , , ], [Xml~Namespace, 4, , , ], [KEYCODE-NO, 5, , 69684558, 69684558], [STORE-NO, 6, , 20, 20], [DATE, 7, , 40118, 40118], [DEPT-NO, 8, , 280, 280], [QTY-SOLD, 9, , 1, 1], [SALE-PRICE, 10, , 5.01, 5.01], [Xml~End, 1, , True, True], [Following~Text, 2, , , ]]')
		select('Table', 'cell:Data,6(280)')
		click('Right')
		select('Table', 'cell:Data,5(40118)')
		select('Table', 'cell:Data,5(40118)')
		assert_p('Table', 'Content', '[[Xml~Name, 0, , DTAR020, DTAR020], [Xml~Prefix, 3, , , ], [Xml~Namespace, 4, , , ], [KEYCODE-NO, 5, , 69694158, 69694158], [STORE-NO, 6, , 20, 20], [DATE, 7, , 40118, 40118], [DEPT-NO, 8, , 280, 280], [QTY-SOLD, 9, , 1, 1], [SALE-PRICE, 10, , 19.00, 19.00], [Xml~End, 1, , True, True], [Following~Text, 2, , , ]]')
	close()
