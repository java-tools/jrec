useFixture(RecordEditor)

def test():
	from Modules import commonBits
	java_recorded_version = '1.5.0_11'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'DTAR020.bin')
		click(commonBits.fl('Edit') + '1')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Sorted Field Tree'))
#		select('List', 'DTAR020')
		select('Table', 'STORE-NO', commonBits.fl('Field') + ',0')
		select('Table', 'DEPT-NO', commonBits.fl('Field') + ',1')
		select('Table', 'cell:' + commonBits.fl('Field') + ',1(DEPT-NO)')
		click(commonBits.fl('Build Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,1(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,1')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',4(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,4')
		select_menu(commonBits.fl('Copy Record#{s#}'))
		select('JTreeTable', 'cell:KEYCODE-NO,6(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,6')
		select_menu(commonBits.fl('Paste Record#{s#}'))
		select('JTreeTable', 'rows:[6,7,8],columns:[KEYCODE-NO]')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
		select('JTreeTable', 'rows:[6,7,8],columns:[KEYCODE-NO]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,1(60694698)')
		assert_p('Table', 'Text', '64614401', '1 - 8|KEYCODE-NO,3')
		select('Table', 'cell:1 - 8|KEYCODE-NO,2(60664659)')
		assert_p('Table', 'RowCount', '7')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(64614401)')
		assert_p('Table', 'Content', '[[67674686, 59, 40118, 929, 1, 3.99], [60694698, 59, 40118, 620, 1, 3.99], [60664659, 59, 40118, 620, 1, 3.99], [64614401, 59, 40118, 957, 1, 1.99], [64614401, 59, 40118, 957, 1, 1.99], [62684217, 59, 40118, 957, 1, 9.99], [64624770, 59, 40118, 957, 1, 2.59]]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(64614401)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',7(null)')
		rightclick('JTreeTable', commonBits.fl('Tree') + ',7')
		select_menu(commonBits.fl('Delete Record#{s#}'))

		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',6(null)')
		assert_p('JTreeTable', 'RowCount', '10')
		select('JTreeTable', 'rows:[6,7],columns:[KEYCODE-NO]')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
		select('JTreeTable', 'rows:[6,7],columns:[KEYCODE-NO]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,0(67674686)')
		assert_p('Table', 'Text', '64614401', '1 - 8|KEYCODE-NO,1')
		select('Table', 'cell:1 - 8|KEYCODE-NO,4(64624770)')
		assert_p('Table', 'Text', '64624770', '1 - 8|KEYCODE-NO,4')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(62684217)')
		assert_p('Table', 'RowCount', '5')
		select('Table', 'cell:1 - 8|KEYCODE-NO,1(64614401)')
		assert_p('Table', 'Content', '[[67674686, 59, 40118, 929, 1, 3.99], [64614401, 59, 40118, 957, 1, 1.99], [64614401, 59, 40118, 957, 1, 1.99], [62684217, 59, 40118, 957, 1, 9.99], [64624770, 59, 40118, 957, 1, 2.59]]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,1(64614401)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',6(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,6')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,8(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,8')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,10(64614401)')
		assert_p('JTreeTable', 'Text', '59', 'STORE-NO,11')
		select('JTreeTable', 'cell:KEYCODE-NO,11(62684217)')
		assert_p('JTreeTable', 'RowCount', '15')
		select('JTreeTable', 'cell:KEYCODE-NO,9(64614401)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , 67674686, 59, 40118, 929, 1, 3.99], [, , , , , , , ], [, , 64614401, 59, 40118, 957, 1, 1.99], [, , 64614401, 59, 40118, 957, 1, 1.99], [, , 62684217, 59, 40118, 957, 1, 9.99], [, , 64624770, 59, 40118, 957, 1, 2.59], [, , , , , , , ], [, , , , , , , ]]')
		select('JTreeTable', 'cell:KEYCODE-NO,6(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,6')
		select_menu(commonBits.fl('Collapse Tree'))
		select('JTreeTable', 'rows:[9,10],columns:[KEYCODE-NO]')
		rightclick('JTreeTable', 'KEYCODE-NO,9')
		select_menu(commonBits.fl('Delete Record#{s#}'))

		select('JTreeTable', 'cell:KEYCODE-NO,8(64614401)')
		assert_p('JTreeTable', 'RowCount', '12')
		select('JTreeTable', 'cell:KEYCODE-NO,9(64624770)')
		assert_p('JTreeTable', 'Text', '', 'KEYCODE-NO,10')
		select('JTreeTable', 'cell:KEYCODE-NO,8(64614401)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , 64614401, 59, 40118, 957, 1, 1.99], [, , 64624770, 59, 40118, 957, 1, 2.59], [, , , , , , , ], [, , , , , , , ]]')
		select('JTreeTable', 'cell:KEYCODE-NO,3(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,3')
		select_menu(commonBits.fl('Delete Record#{s#}'))

		select('JTreeTable', 'rows:[2,3],columns:[KEYCODE-NO]')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
		select('JTreeTable', 'rows:[2,3],columns:[KEYCODE-NO]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,0(61664713)')
		assert_p('Table', 'Content', '[[61664713, 59, 40118, 335, 1, 17.99], [61664713, 59, 40118, 335, -1, -17.99], [61684613, 59, 40118, 335, 1, 12.99], [60694698, 59, 40118, 620, 1, 3.99], [60664659, 59, 40118, 620, 1, 3.99]]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,1(61664713)')
		assert_p('Table', 'RowCount', '5')
		select('Table', 'cell:1 - 8|KEYCODE-NO,4(60664659)')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(60694698)')
		assert_p('Table', 'Text', '60694698', '1 - 8|KEYCODE-NO,3')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(60694698)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('JTreeTable', 'cell:KEYCODE-NO,0(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,0')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,7(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,7')
		select_menu(commonBits.fl('Delete Record#{s#}'))

		select('JTreeTable', 'cell:KEYCODE-NO,6(null)')
		assert_p('JTreeTable', 'RowCount', '13')
		select('JTreeTable', 'rows:[5,6,7],columns:[KEYCODE-NO]')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
		select('JTreeTable', 'rows:[5,6,7],columns:[KEYCODE-NO]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,0(64634429)')
		assert_p('Table', 'Text', '66624458', '1 - 8|KEYCODE-NO,1')
		select('Table', 'cell:1 - 8|KEYCODE-NO,4(60664659)')
		assert_p('Table', 'Text', '60664659', '1 - 8|KEYCODE-NO,4')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(60694698)')
		assert_p('Table', 'Content', '[[64634429, 20, 40118, 957, 1, 3.99], [66624458, 20, 40118, 957, 1, 0.89], [63674861, 20, 40118, 957, 10, 2.70], [60694698, 59, 40118, 620, 1, 3.99], [60664659, 59, 40118, 620, 1, 3.99]]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,2(63674861)')
		assert_p('Table', 'RowCount', '5')
		select('Table', 'cell:1 - 8|KEYCODE-NO,2(63674861)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('JTreeTable', 'cell:KEYCODE-NO,11(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,11')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,10(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,10')
		select_menu(commonBits.fl('Delete Record#{s#}'))

		select('JTreeTable', 'cell:KEYCODE-NO,1(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,1')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,5(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,5')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,4(null)')
		assert_p('JTreeTable', 'RowCount', '55')
		select('JTreeTable', 'rows:[4,5,6],columns:[KEYCODE-NO]')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
		select('JTreeTable', 'rows:[4,5,6],columns:[KEYCODE-NO]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,0(67674686)')
		assert_p('Table', 'Text', '67674686', '1 - 8|KEYCODE-NO,0')
		select('Table', 'cell:1 - 8|KEYCODE-NO,5(60614707)')
		assert_p('Table', 'Text', '60614707', '1 - 8|KEYCODE-NO,5')
		select('Table', 'cell:1 - 8|KEYCODE-NO,4(68654655)')
		assert_p('Table', 'Content', '[[67674686, 59, 40118, 929, 1, 3.99], [60614646, 166, 40118, 60, 1, 6.00], [69654084, 166, 40118, 60, 1, 6.00], [69644897, 166, 40118, 60, 1, 5.08], [68654655, 166, 40118, 60, 1, 5.08], [60614707, 166, 40118, 60, 1, 6.00]]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,2(69654084)')
		assert_p('Table', 'RowCount', '6')
		select('Table', 'cell:1 - 8|KEYCODE-NO,2(69654084)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('Table', 'cell:1 - 8|KEYCODE-NO,4(69694158)')
		assert_p('Table', 'RowCount', '371')
		select('Table', 'cell:1 - 8|KEYCODE-NO,4(69694158)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')

		if window(commonBits.fl('Save Changes to file: ' + commonBits.sampleDir() + 'DTAR020.bin')):
			click('No')
		close()
	close()
