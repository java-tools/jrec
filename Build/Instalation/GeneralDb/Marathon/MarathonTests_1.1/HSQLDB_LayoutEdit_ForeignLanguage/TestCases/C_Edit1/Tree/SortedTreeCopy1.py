useFixture(RecordEditor)

def test():
	from Modules import commonBits
	java_recorded_version = '1.5.0_11'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'DTAR020.bin')
		click(commonBits.fl('Edit') + '1')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Sorted Field Tree'))
#		select('List', 'DTAR020')
		select('Table', 'STORE-NO', commonBits.fl('Field') + ',0')
		select('Table', 'DEPT-NO', commonBits.fl('Field') + ',1')
		select('Table', 'cell:' + commonBits.fl('Field') + ',1(DEPT-NO)')
		click(commonBits.fl('Build Tree'))
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',0(null)')
		rightclick('JTreeTable', commonBits.fl('Tree') + ',0')
		select_menu(commonBits.fl('Copy Record#{s#}'))
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',3(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,3')
		select_menu(commonBits.fl('Paste Record#{s#}'))
		select('JTreeTable', 'cell:KEYCODE-NO,3(null)')
		assert_p('JTreeTable', 'RowCount', '5')
		select('JTreeTable', 'cell:KEYCODE-NO,4(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,4')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',7(null)')
		assert_p('JTreeTable', 'RowCount', '10')
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',7(null)')
		rightclick('JTreeTable', commonBits.fl('Tree') + ',7')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,8(62684671)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , 62684671, 20, 40118, 685, 1, 69.99], [, , 62684671, 20, 40118, 685, -1, -69.99], [, , , , , , , ], [, , , , , , , ]]')
		select('JTreeTable', 'cell:KEYCODE-NO,5(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,5')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,6(63604808)')
		assert_p('JTreeTable', 'Text', '63604808', 'KEYCODE-NO,6')
		select('JTreeTable', 'cell:STORE-NO,6(20)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , 63604808, 20, 40118, 170, 1, 4.87], [, , , , , , , ], [, , , , , , , ], [, , 62684671, 20, 40118, 685, 1, 69.99], [, , 62684671, 20, 40118, 685, -1, -69.99], [, , , , , , , ], [, , , , , , , ]]')
		select('JTreeTable', 'cell:KEYCODE-NO,11(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,11')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,12(65674532)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , , , , , , ], [, , 63604808, 20, 40118, 170, 1, 4.87], [, , , , , , , ], [, , , , , , , ], [, , 62684671, 20, 40118, 685, 1, 69.99], [, , 62684671, 20, 40118, 685, -1, -69.99], [, , , , , , , ], [, , 65674532, 20, 40118, 929, 1, 3.59], [, , , , , , , ]]')
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',3(null)')
		rightclick('JTreeTable', commonBits.fl('Tree') + ',3')
		select_menu(commonBits.fl('Expand Tree'))
		click('ScrollPane$ScrollBar', 5, 364)
		click('ScrollPane$ScrollBar', 10, 374)
		#select('JTreeTable', 'rows:[58,59,60,61,62,63,64,65,66,67,68],columns:[' + commonBits.fl('Tree') + ']')
		select('JTreeTable', 'rows:[58,59,60,61,62,63],columns:[' + commonBits.fl('Tree') + ']')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
		select('JTreeTable', 'rows:[58,59,60,61,62,63],columns:[' + commonBits.fl('Tree') + ']')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(69684558)')
		assert_p('Table', 'Content', '[[60694909, 184, 40118, 998, 1, 2.00], [63604808, 20, 40118, 170, 1, 4.87], [69684558, 20, 40118, 280, 1, 19.00], [69684558, 20, 40118, 280, -1, -19.00], [69684558, 20, 40118, 280, 1, 5.01], [69694158, 20, 40118, 280, 1, 19.00], [69694158, 20, 40118, 280, -1, -19.00], [69694158, 20, 40118, 280, 1, 5.01]]')

		#if window('Save Changes to file: ' + commonBits.sampleDir() + 'DTAR020.bin'):
		#	click('No')
		#close()
	close()
