useFixture(RecordEditor)

###
###  Problem Nimbus ???
###
def test():
	from Modules import commonBits
	java_recorded_version = '1.5.0_11'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'DTAR020.bin')
		click(commonBits.fl('Edit') + '1')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Sorted Field Tree'))
#		select('List', 'DTAR020')
		select('Table', 'STORE-NO', commonBits.fl('Field') + ',0')
		select('Table', 'DEPT-NO', commonBits.fl('Field') + ',1')
		select('Table', 'cell:' + commonBits.fl('Field') + ',1(DEPT-NO)')
		click(commonBits.fl('Build Tree'))
		select('JTreeTable', 'cell:KEYCODE-NO,2(null)')
		rightclick('JTreeTable', 'STORE-NO,2')
		select_menu(commonBits.fl('Delete Record#{s#}'))

		#select('JTreeTable', '')
		rightclick('JTreeTable', 'KEYCODE-NO,1')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',8(null)')
		rightclick('JTreeTable', commonBits.fl('Tree') + ',8')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'rows:[7,8,9],columns:[' + commonBits.fl('Tree') + ']')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
		select('JTreeTable', 'rows:[7,8,9],columns:[' + commonBits.fl('Tree') + ']')
		select('Table', 'cell:1 - 8|KEYCODE-NO,0(64614401)')
		assert_p('Table', 'Text', '59', '9 - 2|STORE-NO,1')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(64624770)')
		assert_p('Table', 'Content', '[[64614401, 59, 40118, 957, 1, 1.99], [64614401, 59, 40118, 957, 1, 1.99], [62684217, 59, 40118, 957, 1, 9.99], [64624770, 59, 40118, 957, 1, 2.59], [60664048, 184, 40118, 60, -1, -4.80], [60614866, 184, 40118, 60, -1, -4.80], [60664048, 184, 40118, 60, -1, -4.80], [60664048, 184, 40118, 60, -1, -4.80], [60614866, 184, 40118, 60, -1, -4.80], [67644821, 184, 40118, 60, -1, -14.99], [67644118, 184, 40118, 60, 1, 16.99], [69654459, 184, 40118, 60, 1, 5.08], [60664779, 184, 40118, 60, 1, 5.08], [68644941, 184, 40118, 60, -1, -10.39], [68644941, 184, 40118, 60, -1, -10.39], [68644941, 184, 40118, 60, -1, -10.39], [68644941, 184, 40118, 60, -1, -10.39], [68644934, 184, 40118, 60, 1, 10.39], [69654638, 184, 40118, 60, 1, 6.00], [67634923, 184, 40118, 60, 1, 17.59]]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,15(68644941)')
		assert_p('Table', 'Text', '68644934', '1 - 8|KEYCODE-NO,17')
		select('Table', 'cell:1 - 8|KEYCODE-NO,4(60664048)')
		assert_p('Table', 'Text', '60664048', '1 - 8|KEYCODE-NO,4')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(64624770)')
		assert_p('Table', 'Text', '60664048', '1 - 8|KEYCODE-NO,4')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(64624770)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select_menu(commonBits.fl('Window') + '>>DTAR020.bin>>' + commonBits.fl('Table:'))
		select('Table', 'cell:1 - 8|KEYCODE-NO,7(62684671)')
		assert_p('Table', 'RowCount', '233')
		select('Table', 'cell:1 - 8|KEYCODE-NO,7(62684671)')
		select_menu(commonBits.fl('Window') + '>>DTAR020.bin>>' + commonBits.fl('Tree View'))
		select('Table', 'cell:1 - 8|KEYCODE-NO,7(62684671)')
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',8(null)')
		rightclick('JTreeTable', commonBits.fl('Tree') + ',8')
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',4(null)')
		rightclick('JTreeTable', commonBits.fl('Tree') + ',4')
		select_menu(commonBits.fl('Delete Record#{s#}'))

		select('JTreeTable', 'rows:[3,4],columns:[' + commonBits.fl('Tree') + ']')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
		select('JTreeTable', 'rows:[3,4],columns:[' + commonBits.fl('Tree') + ']')
		select('Table', 'cell:1 - 8|KEYCODE-NO,0(68634752)')
		assert_p('Table', 'Content', '[[68634752, 59, 40118, 410, 1, 8.99], [60614487, 59, 40118, 878, 1, 5.95], [63644339, 59, 40118, 878, 1, 12.65]]')
		select('Table', 'cell:15 - 2|DEPT-NO,1(878)')
		assert_p('Table', 'Text', 'cell:15 - 2|DEPT-NO,1(878)')
		select('Table', 'cell:11 - 4|DATE,2(40118)')
		assert_p('Table', 'RowCount', '3')
		select('Table', 'cell:11 - 4|DATE,2(40118)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select_menu(commonBits.fl('Window') + '>>DTAR020.bin>>' + commonBits.fl('Table:'))
		select('Table', 'cell:1 - 8|KEYCODE-NO,5(69694158)')
		assert_p('Table', 'RowCount', '231')
		select('Table', 'cell:1 - 8|KEYCODE-NO,5(69694158)')
		select_menu(commonBits.fl('Window') + '>>DTAR020.bin>>' + commonBits.fl('Tree View'))
		select('Table', 'cell:1 - 8|KEYCODE-NO,5(69694158)')
		select('JTreeTable', 'cell:' + commonBits.fl('Tree') + ',0(null)')
		click('Delete1')
		select('JTreeTable', 'cell:KEYCODE-NO,0(null)')
		rightclick('JTreeTable', 'KEYCODE-NO,0')
		select_menu(commonBits.fl('Expand Tree'))
		select('JTreeTable', 'rows:[1,2],columns:[' + commonBits.fl('Tree') + ']')
		select_menu(commonBits.fl('View') + '>>' + commonBits.fl('Table View #{Selected Records#}'))
		select('JTreeTable', 'rows:[1,2],columns:[' + commonBits.fl('Tree') + ']')
		select('Table', 'cell:1 - 8|KEYCODE-NO,0(61664713)')
		assert_p('Table', 'Content', '[[61664713, 59, 40118, 335, 1, 17.99], [61664713, 59, 40118, 335, -1, -17.99], [61684613, 59, 40118, 335, 1, 12.99], [68634752, 59, 40118, 410, 1, 8.99]]')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(68634752)')
		assert_p('Table', 'Text', '68634752', '1 - 8|KEYCODE-NO,3')
		select('Table', 'cell:15 - 2|DEPT-NO,0(335)')
		assert_p('Table', 'Text', '335', '15 - 2|DEPT-NO,0')
		select('Table', 'cell:15 - 2|DEPT-NO,0(335)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('Table', 'cell:1 - 8|KEYCODE-NO,0(64614401)')
		assert_p('Table', 'Text', '64614401', '1 - 8|KEYCODE-NO,1')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(61664713)')
		assert_p('Table', 'RowCount', '218')
		select('Table', 'cell:1 - 8|KEYCODE-NO,3(61664713)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')

		if window(commonBits.fl('Save Changes to file: ' + commonBits.sampleDir() + 'DTAR020.bin')):
			click('No')
		close()
	close()
