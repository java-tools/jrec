#{{{ Marathon
from default import *
#}}} Marathon

from Modules import commonBits

def test():

    set_java_recorded_version("1.6.0_22")
    if frame(' - Open File:0'):
        select('File', commonBits.sampleDir() + 'DTAR020_tst1.bin')
        click('Edit')
    close()

    if window('Record Editor'):
        select_menu('View>>Sorted Field Tree')

        if frame('Create Sorted Tree - DTAR020_tst1.bin:0'):
            select('JTable_10', 'DEPT-NO', '{0, Field}')
            select('JTable_10', 'STORE-NO', '{1, Field}')
            select('JTable_10', 'rows:[1],columns:[Field]')
            click('Build Tree')
        close()


        select_menu('File>>Export as CSV file')

        if frame('Export - DTAR020_tst1.bin:0'):
            print get_window()  

            select('Only export Nodes with Data', 'false')
            select('Edit Output File', 'true')
            select('Keep screen open', 'true')
            select('names on first line', 'true')
            select('Delimiter', ';')
            click('save file')
        close()

        if frame('Table:  - DTAR020_tst1.bin.csv:0'):
            assert_content('JTable_22', [ ['File', '', '', '', '', '', '', '', '', ''],
['File', '60', '', '', '', '', '', '', '', ''],
['File', '60', '166', '', '', '', '', '', '', ''],
['File', '60', '166', '', '68654655', '166', '40118', '60', '1', '5.08'],
['File', '80', '', '', '', '', '', '', '', ''],
['File', '80', '166', '', '', '', '', '', '', ''],
['File', '80', '166', '', '69624033', '166', '40118', '80', '1', '18.19'],
['File', '80', '166', '', '60604100', '166', '40118', '80', '1', '13.30'],
['File', '170', '', '', '', '', '', '', '', ''],
['File', '170', '20', '', '', '', '', '', '', ''],
['File', '170', '20', '', '63604808', '20', '40118', '170', '1', '4.87'],
['File', '170', '166', '', '', '', '', '', '', ''],
['File', '170', '166', '', '68674560', '166', '40118', '170', '1', '5.99'],
['File', '280', '', '', '', '', '', '', '', ''],
['File', '280', '20', '', '', '', '', '', '', ''],
['File', '280', '20', '', '69684558', '20', '40118', '280', '1', '19.00'],
['File', '280', '20', '', '69684558', '20', '40118', '280', '-1', '-19.00'],
['File', '280', '20', '', '69694158', '20', '40118', '280', '1', '5.01'],
['File', '335', '', '', '', '', '', '', '', ''],
['File', '335', '59', '', '', '', '', '', '', ''],
['File', '335', '59', '', '61664713', '59', '40118', '335', '1', '17.99'],
['File', '335', '59', '', '61664713', '59', '40118', '335', '-1', '-17.99'],
['File', '335', '59', '', '61684613', '59', '40118', '335', '1', '12.99'],
['File', '410', '', '', '', '', '', '', '', ''],
['File', '410', '59', '', '', '', '', '', '', ''],
['File', '410', '59', '', '68634752', '59', '40118', '410', '1', '8.99'],
['File', '620', '', '', '', '', '', '', '', ''],
['File', '620', '59', '', '', '', '', '', '', ''],
['File', '620', '59', '', '60694698', '59', '40118', '620', '1', '3.99'],
['File', '620', '59', '', '60664659', '59', '40118', '620', '1', '3.99'],
['File', '685', '', '', '', '', '', '', '', ''],
['File', '685', '20', '', '', '', '', '', '', ''],
['File', '685', '20', '', '62684671', '20', '40118', '685', '1', '69.99'],
['File', '685', '20', '', '62684671', '20', '40118', '685', '-1', '-69.99'],
['File', '878', '', '', '', '', '', '', '', ''],
['File', '878', '59', '', '', '', '', '', '', ''],
['File', '878', '59', '', '60614487', '59', '40118', '878', '1', '5.95']
])
            select('JTable_22', 'rows:[0],columns:[2|Level_2]')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '10|SALE-PRICE', '10|SALE-PRICE')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '8|DEPT-NO', '8|DEPT-NO')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '5|KEYCODE-NO', '5|KEYCODE-NO')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '3|Level_3', '3|Level_3')
            select('Layouts', 'Full Line')
            assert_content('JTable_22', [ ['File;;;;;;;;;'],
['File;60;;;;;;;;'],
['File;60;166;;;;;;;'],
['File;60;166;;68654655;166;40118;60;1;5.08'],
['File;80;;;;;;;;'],
['File;80;166;;;;;;;'],
['File;80;166;;69624033;166;40118;80;1;18.19'],
['File;80;166;;60604100;166;40118;80;1;13.30'],
['File;170;;;;;;;;'],
['File;170;20;;;;;;;'],
['File;170;20;;63604808;20;40118;170;1;4.87'],
['File;170;166;;;;;;;'],
['File;170;166;;68674560;166;40118;170;1;5.99'],
['File;280;;;;;;;;'],
['File;280;20;;;;;;;'],
['File;280;20;;69684558;20;40118;280;1;19.00'],
['File;280;20;;69684558;20;40118;280;-1;-19.00'],
['File;280;20;;69694158;20;40118;280;1;5.01'],
['File;335;;;;;;;;'],
['File;335;59;;;;;;;'],
['File;335;59;;61664713;59;40118;335;1;17.99'],
['File;335;59;;61664713;59;40118;335;-1;-17.99'],
['File;335;59;;61684613;59;40118;335;1;12.99'],
['File;410;;;;;;;;'],
['File;410;59;;;;;;;'],
['File;410;59;;68634752;59;40118;410;1;8.99'],
['File;620;;;;;;;;'],
['File;620;59;;;;;;;'],
['File;620;59;;60694698;59;40118;620;1;3.99'],
['File;620;59;;60664659;59;40118;620;1;3.99'],
['File;685;;;;;;;;'],
['File;685;20;;;;;;;'],
['File;685;20;;62684671;20;40118;685;1;69.99'],
['File;685;20;;62684671;20;40118;685;-1;-69.99'],
['File;878;;;;;;;;'],
['File;878;59;;;;;;;'],
['File;878;59;;60614487;59;40118;878;1;5.95']
])
            click('Close')
        close()

        print get_window() 

        select_menu('Window>>DTAR020_tst1.bin>>Export')
        print get_window()
        
        if frame('Export - DTAR020_tst1.bin:0'):
            print get_window() 
            
#            select('JTable_37', 'rows:[4],columns:[Include]')
#            select('JTable_37', 'false', '{2, Include}')
#            select('JTable_37', 'rows:[2],columns:[Include]')
#            select('JTable_37', 'false', '{4, Include}')
            select('JTable_35', 'rows:[4],columns:[Include]')
            select('JTable_35', 'false', '{2, Include}')
            select('JTable_35', 'rows:[2],columns:[Include]')
            select('JTable_35', 'false', '{4, Include}')
            click('save file')
        close()

        if frame('Table:  - DTAR020_tst1.bin.csv:0'):
            assert_content('JTable_22', [ ['File', '', '', '', '', '', '', ''],
['File', '60', '', '', '', '', '', ''],
['File', '60', '166', '', '', '', '', ''],
['File', '60', '166', '', '68654655', '166', '60', '5.08'],
['File', '80', '', '', '', '', '', ''],
['File', '80', '166', '', '', '', '', ''],
['File', '80', '166', '', '69624033', '166', '80', '18.19'],
['File', '80', '166', '', '60604100', '166', '80', '13.30'],
['File', '170', '', '', '', '', '', ''],
['File', '170', '20', '', '', '', '', ''],
['File', '170', '20', '', '63604808', '20', '170', '4.87'],
['File', '170', '166', '', '', '', '', ''],
['File', '170', '166', '', '68674560', '166', '170', '5.99'],
['File', '280', '', '', '', '', '', ''],
['File', '280', '20', '', '', '', '', ''],
['File', '280', '20', '', '69684558', '20', '280', '19.00'],
['File', '280', '20', '', '69684558', '20', '280', '-19.00'],
['File', '280', '20', '', '69694158', '20', '280', '5.01'],
['File', '335', '', '', '', '', '', ''],
['File', '335', '59', '', '', '', '', ''],
['File', '335', '59', '', '61664713', '59', '335', '17.99'],
['File', '335', '59', '', '61664713', '59', '335', '-17.99'],
['File', '335', '59', '', '61684613', '59', '335', '12.99'],
['File', '410', '', '', '', '', '', ''],
['File', '410', '59', '', '', '', '', ''],
['File', '410', '59', '', '68634752', '59', '410', '8.99'],
['File', '620', '', '', '', '', '', ''],
['File', '620', '59', '', '', '', '', ''],
['File', '620', '59', '', '60694698', '59', '620', '3.99'],
['File', '620', '59', '', '60664659', '59', '620', '3.99'],
['File', '685', '', '', '', '', '', ''],
['File', '685', '20', '', '', '', '', ''],
['File', '685', '20', '', '62684671', '20', '685', '69.99'],
['File', '685', '20', '', '62684671', '20', '685', '-69.99'],
['File', '878', '', '', '', '', '', ''],
['File', '878', '59', '', '', '', '', ''],
['File', '878', '59', '', '60614487', '59', '878', '5.95']
])
            select('JTable_22', 'rows:[0],columns:[2|Level_2]')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '7|DEPT-NO', '7|DEPT-NO')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '6|STORE-NO', '6|STORE-NO')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '5|KEYCODE-NO', '5|KEYCODE-NO')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '3|Level_3', '3|Level_3')
            select('Layouts', 'Full Line')
            assert_content('JTable_22', [ ['File;;;;;;;'],
['File;60;;;;;;'],
['File;60;166;;;;;'],
['File;60;166;;68654655;166;60;5.08'],
['File;80;;;;;;'],
['File;80;166;;;;;'],
['File;80;166;;69624033;166;80;18.19'],
['File;80;166;;60604100;166;80;13.30'],
['File;170;;;;;;'],
['File;170;20;;;;;'],
['File;170;20;;63604808;20;170;4.87'],
['File;170;166;;;;;'],
['File;170;166;;68674560;166;170;5.99'],
['File;280;;;;;;'],
['File;280;20;;;;;'],
['File;280;20;;69684558;20;280;19.00'],
['File;280;20;;69684558;20;280;-19.00'],
['File;280;20;;69694158;20;280;5.01'],
['File;335;;;;;;'],
['File;335;59;;;;;'],
['File;335;59;;61664713;59;335;17.99'],
['File;335;59;;61664713;59;335;-17.99'],
['File;335;59;;61684613;59;335;12.99'],
['File;410;;;;;;'],
['File;410;59;;;;;'],
['File;410;59;;68634752;59;410;8.99'],
['File;620;;;;;;'],
['File;620;59;;;;;'],
['File;620;59;;60694698;59;620;3.99'],
['File;620;59;;60664659;59;620;3.99'],
['File;685;;;;;;'],
['File;685;20;;;;;'],
['File;685;20;;62684671;20;685;69.99'],
['File;685;20;;62684671;20;685;-69.99'],
['File;878;;;;;;'],
['File;878;59;;;;;'],
['File;878;59;;60614487;59;878;5.95']
])
            click('Close')
        close()

        if frame('Export - DTAR020_tst1.bin:0'):
            select('Delimiter', ',')
            click('save file')
        close()

        if frame('Table:  - DTAR020_tst1.bin.csv:0'):
            assert_content('JTable_22', [ ['File', '', '', '', '', '', '', ''],
['File', '60', '', '', '', '', '', ''],
['File', '60', '166', '', '', '', '', ''],
['File', '60', '166', '', '68654655', '166', '60', '5.08'],
['File', '80', '', '', '', '', '', ''],
['File', '80', '166', '', '', '', '', ''],
['File', '80', '166', '', '69624033', '166', '80', '18.19'],
['File', '80', '166', '', '60604100', '166', '80', '13.30'],
['File', '170', '', '', '', '', '', ''],
['File', '170', '20', '', '', '', '', ''],
['File', '170', '20', '', '63604808', '20', '170', '4.87'],
['File', '170', '166', '', '', '', '', ''],
['File', '170', '166', '', '68674560', '166', '170', '5.99'],
['File', '280', '', '', '', '', '', ''],
['File', '280', '20', '', '', '', '', ''],
['File', '280', '20', '', '69684558', '20', '280', '19.00'],
['File', '280', '20', '', '69684558', '20', '280', '-19.00'],
['File', '280', '20', '', '69694158', '20', '280', '5.01'],
['File', '335', '', '', '', '', '', ''],
['File', '335', '59', '', '', '', '', ''],
['File', '335', '59', '', '61664713', '59', '335', '17.99'],
['File', '335', '59', '', '61664713', '59', '335', '-17.99'],
['File', '335', '59', '', '61684613', '59', '335', '12.99'],
['File', '410', '', '', '', '', '', ''],
['File', '410', '59', '', '', '', '', ''],
['File', '410', '59', '', '68634752', '59', '410', '8.99'],
['File', '620', '', '', '', '', '', ''],
['File', '620', '59', '', '', '', '', ''],
['File', '620', '59', '', '60694698', '59', '620', '3.99'],
['File', '620', '59', '', '60664659', '59', '620', '3.99'],
['File', '685', '', '', '', '', '', ''],
['File', '685', '20', '', '', '', '', ''],
['File', '685', '20', '', '62684671', '20', '685', '69.99'],
['File', '685', '20', '', '62684671', '20', '685', '-69.99'],
['File', '878', '', '', '', '', '', ''],
['File', '878', '59', '', '', '', '', ''],
['File', '878', '59', '', '60614487', '59', '878', '5.95']
])
            select('JTable_22', 'rows:[0],columns:[2|Level_2]')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '8|SALE-PRICE', '8|SALE-PRICE')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '8|SALE-PRICE', '8|SALE-PRICE')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '7|DEPT-NO', '7|DEPT-NO')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '6|STORE-NO', '6|STORE-NO')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '5|KEYCODE-NO', '5|KEYCODE-NO')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '2|Level_2', '2|Level_2')
            select('Layouts', 'Full Line')
            assert_p('JTable_22', 'Text', 'File,170,20,,,,,', '{9, Full Line}')
            assert_content('JTable_22', [ ['File,,,,,,,'],
['File,60,,,,,,'],
['File,60,166,,,,,'],
['File,60,166,,68654655,166,60,5.08'],
['File,80,,,,,,'],
['File,80,166,,,,,'],
['File,80,166,,69624033,166,80,18.19'],
['File,80,166,,60604100,166,80,13.30'],
['File,170,,,,,,'],
['File,170,20,,,,,'],
['File,170,20,,63604808,20,170,4.87'],
['File,170,166,,,,,'],
['File,170,166,,68674560,166,170,5.99'],
['File,280,,,,,,'],
['File,280,20,,,,,'],
['File,280,20,,69684558,20,280,19.00'],
['File,280,20,,69684558,20,280,-19.00'],
['File,280,20,,69694158,20,280,5.01'],
['File,335,,,,,,'],
['File,335,59,,,,,'],
['File,335,59,,61664713,59,335,17.99'],
['File,335,59,,61664713,59,335,-17.99'],
['File,335,59,,61684613,59,335,12.99'],
['File,410,,,,,,'],
['File,410,59,,,,,'],
['File,410,59,,68634752,59,410,8.99'],
['File,620,,,,,,'],
['File,620,59,,,,,'],
['File,620,59,,60694698,59,620,3.99'],
['File,620,59,,60664659,59,620,3.99'],
['File,685,,,,,,'],
['File,685,20,,,,,'],
['File,685,20,,62684671,20,685,69.99'],
['File,685,20,,62684671,20,685,-69.99'],
['File,878,,,,,,'],
['File,878,59,,,,,'],
['File,878,59,,60614487,59,878,5.95']
])
            click('Close')
        close()

        if frame('Export - DTAR020_tst1.bin:0'):
            select('JTable_35', 'rows:[4],columns:[Include]')
            select('JTable_35', 'rows:[2],columns:[Include]')
            select('JTable_35', 'true', '{2, Include}')
            select('JTable_35', 'true', '{4, Include}')

            click('save file')
        close()

        if frame('Table:  - DTAR020_tst1.bin.csv:0'):
            assert_p('JTable_22', 'Text', '69684558', '{16, 5|KEYCODE-NO}')
            select('JTable_22', 'rows:[0],columns:[2|Level_2]')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '10|SALE-PRICE', '10|SALE-PRICE')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '8|DEPT-NO', '8|DEPT-NO')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '7|DATE', '7|DATE')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '5|KEYCODE-NO', '5|KEYCODE-NO')
            assert_p('net.sf.RecordEditor.edit.display.BaseDisplay$HeaderToolTips_27', 'Text', '3|Level_3', '3|Level_3')
            select('Layouts', 'Full Line')
            assert_content('JTable_22', [ ['File,,,,,,,,,'],
['File,60,,,,,,,,'],
['File,60,166,,,,,,,'],
['File,60,166,,68654655,166,40118,60,1,5.08'],
['File,80,,,,,,,,'],
['File,80,166,,,,,,,'],
['File,80,166,,69624033,166,40118,80,1,18.19'],
['File,80,166,,60604100,166,40118,80,1,13.30'],
['File,170,,,,,,,,'],
['File,170,20,,,,,,,'],
['File,170,20,,63604808,20,40118,170,1,4.87'],
['File,170,166,,,,,,,'],
['File,170,166,,68674560,166,40118,170,1,5.99'],
['File,280,,,,,,,,'],
['File,280,20,,,,,,,'],
['File,280,20,,69684558,20,40118,280,1,19.00'],
['File,280,20,,69684558,20,40118,280,-1,-19.00'],
['File,280,20,,69694158,20,40118,280,1,5.01'],
['File,335,,,,,,,,'],
['File,335,59,,,,,,,'],
['File,335,59,,61664713,59,40118,335,1,17.99'],
['File,335,59,,61664713,59,40118,335,-1,-17.99'],
['File,335,59,,61684613,59,40118,335,1,12.99'],
['File,410,,,,,,,,'],
['File,410,59,,,,,,,'],
['File,410,59,,68634752,59,40118,410,1,8.99'],
['File,620,,,,,,,,'],
['File,620,59,,,,,,,'],
['File,620,59,,60694698,59,40118,620,1,3.99'],
['File,620,59,,60664659,59,40118,620,1,3.99'],
['File,685,,,,,,,,'],
['File,685,20,,,,,,,'],
['File,685,20,,62684671,20,40118,685,1,69.99'],
['File,685,20,,62684671,20,40118,685,-1,-69.99'],
['File,878,,,,,,,,'],
['File,878,59,,,,,,,'],
['File,878,59,,60614487,59,40118,878,1,5.95']
])
            click('Close')
        close()

##        window_closed('Record Editor')
    close()

    pass
