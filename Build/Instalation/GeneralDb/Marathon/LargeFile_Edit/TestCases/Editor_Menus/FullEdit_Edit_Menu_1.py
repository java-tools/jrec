useFixture(default)

def test():
	from Modules import commonBits
	java_recorded_version = '1.5.0_11'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'Ams_LocDownload_20041228.txt')
		commonBits.setRecordLayout(select, 'ams Store')
		click('Edit1')
		select('Table', 'rows:[1,2,3,4,5,6,7,8,9,10,11,12,13],columns:[10 - 35|Loc Name]')
		select_menu('Data>>Table View #{Selected Records#}')
##		select('Table2', 'rows:[1,2,3,4,5,6,7,8,9,10,11,12,13],columns:[10 - 35|Loc Name]')
		select('Table', 'rows:[2,3,4],columns:[8 - 2|Loc Type]')
		select_menu('Edit>>Copy Record#{s#}')
		select('Table', 'cell:8 - 2|Loc Type,11(ST)')
		select_menu('Edit>>Paste Record#{s#} Prior')
##		select('Table', 'cell:8 - 2|Loc Type,10(ST)')
		assert_p('Table', 'Content', '[[TAR, 5850, DC, VIC West Ad Support, , Lot 2 Little Boundary Rd, Laverton, 3028, VIC, A], [TAR, 5853, DC, NSW North Sydney Ad Support, , , , , , A], [TAR, 5866, DC, WA Ad Support, , , , , , A], [TAR, 5015, ST, Bankstown, Bankstown, Unit 2, 39-41 Allingham Street, Condell Park, 2200, NSW, A], [TAR, 5019, ST, Penrith, Penrith, 58 Leland Street, Penrith, 2750, NSW, A], [TAR, 5033, ST, Blacktown, Marayong, Dock 2, 11 Melissa Place, Marayong, 2148, NSW, A], [TAR, 5035, ST, Rockdale, Building B,  Portside DC, 2-8 Mc Pherson Street, Botany, 2019, NSW, A], [TAR, 5037, ST, Miranda, Westfield Shoppingtown, Cnr. Urunga Pde & The Kingsway, Miranda, 2228, NSW, A], [TAR, 5052, ST, Eastwood, Marayong Offsite Reserve, 11 Melissa Place, Marayong, 2148, NSW, A], [TAR, 5055, ST, Leichhardt, Marketown, Marion Street, Leichhardt, 2040, NSW, A], [TAR, 5060, ST, St Marys, St. Mary\'s, Charles Hackett Drive, St Mary\'s, 2760, NSW, A], [TAR, 5866, DC, WA Ad Support, , , , , , A], [TAR, 5015, ST, Bankstown, Bankstown, Unit 2, 39-41 Allingham Street, Condell Park, 2200, NSW, A], [TAR, 5019, ST, Penrith, Penrith, 58 Leland Street, Penrith, 2750, NSW, A], [TAR, 5070, ST, Bass Hill, Bass Hill Plaza, 753 Hume Highway, Bass Hill, 2197, NSW, A], [TAR, 5074, ST, Campbelltown, Campbelltown Mall, 303 Queen Street, Campbelltown, 2560, NSW, A]]')

		select('Table', 'cell:8 - 2|Loc Type,10(ST)')
		rightclick('Table', '10 - 35|Loc Name,10')
		select_menu('Edit Record')
##		select('Table1', 'cell:8 - 2|Loc Type,10(ST)')
		select('Table', 'cell:Data,5(Charles Hackett Drive)')
		assert_p('Table', 'Text', 'Charles Hackett Drive', 'Data,5')
		select('Table', 'cell:Data,4(St. Mary\'s)')
		assert_p('Table', 'Content', '[[Brand Id, 1, 3, TAR, TAR], [Loc Nbr, 4, 4, 5060, 5060], [Loc Type, 8, 2, ST, ST], [Loc Name, 10, 35, St Marys, St Marys], [Loc Addr Ln1, 45, 40, St. Mary\'s, St. Mary\'s], [Loc Addr Ln2, 85, 40, Charles Hackett Drive, Charles Hackett Drive], [Loc Addr Ln3, 125, 35, St Mary\'s, St Mary\'s], [Loc Postcode, 160, 10, 2760, 2760], [Loc State, 170, 3, NSW, NSW], [Loc Actv Ind, 173, 1, A, A]]')
		select('Table', 'cell:Data,4(St. Mary\'s)')
		click('Right')
		click('Right')
		select('Table', 'cell:Data,5(Unit 2, 39-41 Allingham Street)')
		assert_p('Table', 'Text', 'Unit 2, 39-41 Allingham Street', 'Data,5')
		select('Table', 'cell:Data,4(Bankstown)')
		assert_p('Table', 'Content', '[[Brand Id, 1, 3, TAR, TAR], [Loc Nbr, 4, 4, 5015, 5015], [Loc Type, 8, 2, ST, ST], [Loc Name, 10, 35, Bankstown, Bankstown], [Loc Addr Ln1, 45, 40, Bankstown, Bankstown], [Loc Addr Ln2, 85, 40, Unit 2, 39-41 Allingham Street, Unit 2, 39-41 Allingham Street], [Loc Addr Ln3, 125, 35, Condell Park, Condell Park], [Loc Postcode, 160, 10, 2200, 2200], [Loc State, 170, 3, NSW, NSW], [Loc Actv Ind, 173, 1, A, A]]')
		select('Table', 'cell:Data,4(Bankstown)')
		click('Right')
		select('Table', 'cell:Data,5(58 Leland Street)')
		assert_p('Table', 'Text', 'cell:Data,5(58 Leland Street)')
		select('Table', 'cell:Data,4(Penrith)')
		assert_p('Table', 'Content', '[[Brand Id, 1, 3, TAR, TAR], [Loc Nbr, 4, 4, 5019, 5019], [Loc Type, 8, 2, ST, ST], [Loc Name, 10, 35, Penrith, Penrith], [Loc Addr Ln1, 45, 40, Penrith, Penrith], [Loc Addr Ln2, 85, 40, 58 Leland Street, 58 Leland Street], [Loc Addr Ln3, 125, 35, Penrith, Penrith], [Loc Postcode, 160, 10, 2750, 2750], [Loc State, 170, 3, NSW, NSW], [Loc Actv Ind, 173, 1, A, A]]')
		select('Table', 'cell:Data,4(Penrith)')
		click('Right')
		select('Table', 'cell:Data,5(753 Hume Highway)')
		assert_p('Table', 'Text', 'cell:Data,5(753 Hume Highway)')
		select('Table', 'cell:Data,4(Bass Hill Plaza)')
		assert_p('Table', 'Content', '[[Brand Id, 1, 3, TAR, TAR], [Loc Nbr, 4, 4, 5070, 5070], [Loc Type, 8, 2, ST, ST], [Loc Name, 10, 35, Bass Hill, Bass Hill], [Loc Addr Ln1, 45, 40, Bass Hill Plaza, Bass Hill Plaza], [Loc Addr Ln2, 85, 40, 753 Hume Highway, 753 Hume Highway], [Loc Addr Ln3, 125, 35, Bass Hill, Bass Hill], [Loc Postcode, 160, 10, 2197, 2197], [Loc State, 170, 3, NSW, NSW], [Loc Actv Ind, 173, 1, A, A]]')
		select('Table', 'cell:Data,4(Bass Hill Plaza)')
		click('Right')
		select('Table', 'cell:Data,5(303 Queen Street)')
		assert_p('Table', 'Text', 'cell:Data,5(303 Queen Street)')
		select('Table', 'cell:Data,4(Campbelltown Mall)')
		assert_p('Table', 'Content', '[[Brand Id, 1, 3, TAR, TAR], [Loc Nbr, 4, 4, 5074, 5074], [Loc Type, 8, 2, ST, ST], [Loc Name, 10, 35, Campbelltown, Campbelltown], [Loc Addr Ln1, 45, 40, Campbelltown Mall, Campbelltown Mall], [Loc Addr Ln2, 85, 40, 303 Queen Street, 303 Queen Street], [Loc Addr Ln3, 125, 35, Campbelltown, Campbelltown], [Loc Postcode, 160, 10, 2560, 2560], [Loc State, 170, 3, NSW, NSW], [Loc Actv Ind, 173, 1, A, A]]')
		select('Table', 'cell:Data,4(Campbelltown Mall)')
		click('BasicInternalFrameTitlePane$NoFocusButton2')
		click('BasicInternalFrameTitlePane$NoFocusButton2')
		#click('WindowsInternalFrameTitlePane', 883, 7)
		click('BasicInternalFrameTitlePane$NoFocusButton2')

		if window('Save Changes to file: ' + commonBits.sampleDir() + 'Ams_LocDownload_20041228.txt'):
			click('No')
		close()
	close()
