useFixture(default)

def test():
	from Modules import commonBits
	java_recorded_version = '1.5.0_11'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'Ams_PODownload_20041231.txt')
		click('Edit1')
		click('Filter')
		select('Table', 'false', 'Include,0')
		select('Table', 'false', 'Include,2')
		#select('Table', 'cell:Include,2(false)')
		click('Filter1')
		select('Table', 'cell:8 - 10|Vendor,2(6228)')
		assert_p('Table', 'Content', '[[H1, 45.349, 6060, 286225, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [H1, 45.350, 6228, 222227, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [H1, 45.351, 6228, 222243, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [H1, 45.352, 5341, 294915, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [H1, 45.353, 5341, 294987, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [H1, 45.354, 5341, 295139, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [H1, 45.355, 5341, 303662, 041110, , 00, , 310, 041231, 050107, P, , , YOUTH SHOE, C, FT], [H1, 45.356, 5341, 304100, 041111, , 00, , 310, 041231, 050107, P, , , YOUTH SHOE, C, FT]]')
		select('Table', 'cell:8 - 10|Vendor,3(5341)')
		assert_p('Table', 'RowCount', '8')
		select('Table', 'cell:8 - 10|Vendor,3(5341)')
		select_menu('View>>Sorted Field Tree')
##		select('Table1', 'cell:8 - 10|Vendor,3(5341)')
		select('List', 'ams PO Download: Detail')
		select('List', 'ams PO Download: Header')
		select('Table', 'Entry Date', 'Field,0')
		select('Table', 'Vendor', 'Field,1')
		select('Table', 'cell:Field,1(Vendor)')
		click('Build Tree')
##		select('JTreeTable', 'cell:APN,1(null)')
		select('JTreeTable', 'cell:Record Type,1(null)')
		assert_p('JTreeTable', 'RowCount', '4')
##		select('JTreeTable', 'cell:Pack Qty,1(null)')
##		rightclick('JTreeTable', 'Pack Qty,1')
		select('JTreeTable', 'cell:Vendor,1(null)')
		rightclick('JTreeTable', 'Vendor,1')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Tree,2(null)')
		assert_p('JTreeTable', 'RowCount', '5')
		select('JTreeTable', 'cell:Tree,3(null)')
		rightclick('JTreeTable', 'Tree,3')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Tree,2(null)')
		rightclick('JTreeTable', 'Tree,2')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Record Type,3(H1)')
		select('JTreeTable', 'cell:Record Type,3(H1)')
		select('LayoutCombo', 'ams PO Download: Header')
		select('JTreeTable', 'cell:PO,4(294987)')
		assert_p('JTreeTable', 'Content', '[[, , , , , , , , , , , , , , , , , , ], [, , , , , , , , , , , , , , , , , , ], [, , , , , , , , , , , , , , , , , , ], [, , H1, 45.352, 5341, 294915, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.353, 5341, 294987, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.354, 5341, 295139, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , , , , , , , , , , , , , , , , , ], [, , , , , , , , , , , , , , , , , , ], [, , , , , , , , , , , , , , , , , , ]]')
		select('JTreeTable', 'cell:Tree,2(null)')
		rightclick('JTreeTable', 'Tree,2')
		select_menu('Collapse Tree')
		select('JTreeTable', 'cell:Tree,1(null)')
		rightclick('JTreeTable', 'Tree,1')
		select_menu('Collapse Tree')
		select('JTreeTable', 'cell:Tree,1(null)')
		select_menu('View>>Record View #{Selected Records#}')
		select('JTreeTable', 'cell:Tree,1(null)')
		select('Table', 'cell:Data,1(45.352)')
		assert_p('Table', 'Content', '[[Record Type, 1, 2, H1, H1], [Sequence Number, 3, 5, 45.352, 45352], [Vendor, 8, 10, 5341, 0000005341], [PO, 18, 12, 294915, 294915], [Entry Date, 30, 6, 041013, 041013], [Filler, 36, 8, , ], [beg01 code, 44, 2, 00, 00], [beg02 code, 46, 2, , ], [Department, 48, 4, 475, 475], [Expected Reciept Date, 52, 6, 041231, 041231], [Cancel by date, 58, 6, 050107, 050107], [EDI Type, 68, 1, P, P], [Add Date, 69, 6, , ], [Filler, 75, 1, , ], [Department Name, 76, 10, WOMENS SHO, WOMENS SHO], [Prcoess Type, 86, 1, C, C], [Order Type, 87, 2, FT, FT]]')
		select('Table', 'cell:Data,1(45.352)')
		click('RightM')
		assert_p('Table', 'Text', '')
		doubleclick('TextField')
		assert_p('TextField', 'Text', '3')
		select('Table', 'cell:Data,3(295139)')
		assert_p('Table', 'Content', '[[Record Type, 1, 2, H1, H1], [Sequence Number, 3, 5, 45.354, 45354], [Vendor, 8, 10, 5341, 0000005341], [PO, 18, 12, 295139, 295139], [Entry Date, 30, 6, 041013, 041013], [Filler, 36, 8, , ], [beg01 code, 44, 2, 00, 00], [beg02 code, 46, 2, , ], [Department, 48, 4, 475, 475], [Expected Reciept Date, 52, 6, 041231, 041231], [Cancel by date, 58, 6, 050107, 050107], [EDI Type, 68, 1, P, P], [Add Date, 69, 6, , ], [Filler, 75, 1, , ], [Department Name, 76, 10, WOMENS SHO, WOMENS SHO], [Prcoess Type, 86, 1, C, C], [Order Type, 87, 2, FT, FT]]')
		select('Table', 'cell:Data,3(295139)')
		click('Left')
		select('Table', 'cell:Data,3(294987)')
		assert_p('Table', 'Content', '[[Record Type, 1, 2, H1, H1], [Sequence Number, 3, 5, 45.353, 45353], [Vendor, 8, 10, 5341, 0000005341], [PO, 18, 12, 294987, 294987], [Entry Date, 30, 6, 041013, 041013], [Filler, 36, 8, , ], [beg01 code, 44, 2, 00, 00], [beg02 code, 46, 2, , ], [Department, 48, 4, 475, 475], [Expected Reciept Date, 52, 6, 041231, 041231], [Cancel by date, 58, 6, 050107, 050107], [EDI Type, 68, 1, P, P], [Add Date, 69, 6, , ], [Filler, 75, 1, , ], [Department Name, 76, 10, WOMENS SHO, WOMENS SHO], [Prcoess Type, 86, 1, C, C], [Order Type, 87, 2, FT, FT]]')
		select('Table', 'cell:Data,3(294987)')
		commonBits.closeWindow(click)
		##click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('JTreeTable', 'cell:Tree,1(null)')
	close()
