useFixture(default)

def test():
	from Modules import commonBits
	java_recorded_version = '1.6.0_17'

	if window('Protocol Buffer Editor'):
		select('FileChooser', commonBits.sampleDir() + 'protoStoreSales3.bin')
		select('FileChooser1',  commonBits.stdCopybookDir() + 'StoreSales3.protocomp')
		click('Edit1')
		select('JTreeTable', 'cell:Tree,1(null)')
		rightclick('JTreeTable', 'Tree,1')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Tree,2(null)')
		rightclick('JTreeTable', 'Tree,2')
		select_menu('Expand Tree')
		select('LayoutCombo', 'Deptartment')
		select('JTreeTable', 'cell:Tree,12(null)')
		rightclick('JTreeTable', 'Tree,12')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Tree,13(null)')
		rightclick('JTreeTable', 'Tree,13')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Tree,5(null)')
		assert_p('JTreeTable', 'Content', '[[, , , ], [, , , ], [, , , ], [, , 335, Department: 335], [, , 410, Department: 410], [, , 620, Department: 620], [, , 878, Department: 878], [, , 929, Department: 929], [, , 957, Department: 957], [, , , ], [, , , ], [, , , ], [, , , ], [, , , ], [, , 60, Department: 60], [, , 70, Department: 70], [, , 80, Department: 80], [, , 160, Department: 160], [, , 170, Department: 170], [, , 193, Department: 193], [, , 220, Department: 220], [, , 230, Department: 230], [, , 235, Department: 235], [, , 250, Department: 250], [, , 261, Department: 261], [, , 265, Department: 265], [, , 270, Department: 270], [, , 275, Department: 275], [, , 280, Department: 280], [, , 290, Department: 290], [, , 310, Department: 310], [, , 320, Department: 320], [, , 345, Department: 345], [, , 350, Department: 350], [, , 355, Department: 355], [, , 366, Department: 366], [, , 375, Department: 375], [, , 405, Department: 405], [, , 415, Department: 415], [, , 432, Department: 432], [, , 471, Department: 471], [, , 475, Department: 475], [, , 485, Department: 485], [, , 490, Department: 490], [, , 500, Department: 500], [, , 530, Department: 530], [, , 590, Department: 590], [, , 620, Department: 620], [, , 650, Department: 650], [, , 670, Department: 670], [, , 801, Department: 801], [, , 805, Department: 805], [, , 830, Department: 830], [, , 845, Department: 845], [, , 851, Department: 851], [, , 855, Department: 855], [, , 870, Department: 870], [, , 875, Department: 875], [, , 878, Department: 878], [, , 901, Department: 901], [, , 902, Department: 902], [, , 903, Department: 903], [, , 904, Department: 904], [, , 905, Department: 905], [, , 929, Department: 929], [, , 940, Department: 940], [, , 957, Department: 957], [, , 970, Department: 970], [, , 998, Department: 998], [, , , ], [, , , ]]')
#		select('JTreeTable', 'cell:Tree,15(null)')
#		click('MetalInternalFrameTitlePane', 653, 14)
##		zzzzzzzzzzz
#		select('JTreeTable', 'rows:[15],columns:[Tree]')
#		select('JTreeTable', 'rows:[15,16],columns:[Tree]')

		select('LayoutCombo', 'Deptartment')
		select('JTreeTable', 'rows:[15,16],columns:[department]')
##		zzzzzzzzzzz
		select_menu('Edit>>Copy Record#{s#}')
		select('JTreeTable', 'cell:Tree,3(null)')
		select_menu('Edit>>Paste Record#{s#}')
		select('JTreeTable', 'cell:Tree,15(null)')
		rightclick('JTreeTable', 'Tree,15')
		select_menu('Collapse Tree')
		select('JTreeTable', 'cell:Tree,3(null)')
		assert_p('JTreeTable', 'Content', '[[, , , ], [, , , ], [, , , ], [, , 335, Department: 335], [, , 70, Department: 70], [, , 80, Department: 80], [, , 410, Department: 410], [, , 620, Department: 620], [, , 878, Department: 878], [, , 929, Department: 929], [, , 957, Department: 957], [, , , ], [, , , ], [, , , ], [, , , ], [, , , ], [, , , ], [, , , ]]')
		select('JTreeTable', 'cell:Tree,4(null)')
		rightclick('JTreeTable', 'Tree,4')
		select_menu('Fully Expand Tree')
		select('LayoutCombo', 'Product')
		select('JTreeTable', 'cell:Tree,17(null)')
		rightclick('JTreeTable', 'Tree,17')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Tree,18(null)')
		rightclick('JTreeTable', 'Tree,18')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Tree,4(null)')
		assert_p('JTreeTable', 'Content', '[[, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , 64614285, 40118, 1, 22990], [, , 67654448, 40118, 1, 23000], [, , 67654448, 40118, -1, -23000], [, , 67654448, 40118, 1, 19010], [, , 68614241, 40118, 1, 12990], [, , 68614787, 40118, 1, 27990], [, , 68634061, 40118, 1, 27990], [, , 69644337, 40118, 1, 29990], [, , 69654081, 40118, 1, 12990], [, , 69654135, 40118, 1, 12990], [, , , , , ], [, , , , , ], [, , , , , ], [, , 68664957, 40118, 1, 13990], [, , 69634699, 40118, 1, 20990], [, , 69634712, 40118, 1, 20990], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ], [, , , , , ]]')
		select('JTreeTable', 'cell:Tree,4(null)')
		rightclick('JTreeTable', 'Tree,4')
		select_menu('Edit Record')
		select('JTreeTable', 'cell:Tree,4(null)')
		select('Table', 'cell:Data,0(70)')
		assert_p('Table', 'Content', '[[department, 1, , 70, 70], [name, 2, , Department: 70, Department: 70]]')
		click('Right')
		select('Table', 'cell:Data,0(80)')
		assert_p('Table', 'Content', '[[department, 1, , 80, 80], [name, 2, , Department: 80, Department: 80]]')
		click('Left')
		click('Down')
		select('Table', 'cell:Data,0(64614285)')
		assert_p('Table', 'Content', '[[keycode, 1, , 64614285, 64614285], [saleDate, 2, , 40118, 40118], [quantity, 3, , 1, 1], [price, 4, , 22990, 22990]]')
		click('Right')
		select('Table', 'cell:Data,1(40118)')
		assert_p('Table', 'Content', '[[keycode, 1, , 67654448, 67654448], [saleDate, 2, , 40118, 40118], [quantity, 3, , 1, 1], [price, 4, , 23000, 23000]]')
		click('Right')
		select('Table', 'cell:Len,0()')
		assert_p('Table', 'Content', '[[keycode, 1, , 67654448, 67654448], [saleDate, 2, , 40118, 40118], [quantity, 3, , -1, -1], [price, 4, , -23000, -23000]]')
		select('Table', 'cell:Len,0()')
		click('Right')
		select('Table', 'cell:Data,0(67654448)')
		assert_p('Table', 'Content', '[[keycode, 1, , 67654448, 67654448], [saleDate, 2, , 40118, 40118], [quantity, 3, , 1, 1], [price, 4, , 19010, 19010]]')
		click('Right')
		select('Table', 'cell:Data,0(68614241)')
		assert_p('Table', 'Content', '[[keycode, 1, , 68614241, 68614241], [saleDate, 2, , 40118, 40118], [quantity, 3, , 1, 1], [price, 4, , 12990, 12990]]')
		click('Right')
		select('Table', 'cell:Data,0(68614787)')
		assert_p('Table', 'Content', '[[keycode, 1, , 68614787, 68614787], [saleDate, 2, , 40118, 40118], [quantity, 3, , 1, 1], [price, 4, , 27990, 27990]]')
		click('Right')
		select('Table', 'cell:Data,1(40118)')
		assert_p('Table', 'Content', '[[keycode, 1, , 68634061, 68634061], [saleDate, 2, , 40118, 40118], [quantity, 3, , 1, 1], [price, 4, , 27990, 27990]]')
		click('Right')
		click('Right')
		select('Table', 'cell:Data,0(69654081)')
		assert_p('Table', 'Content', '[[keycode, 1, , 69654081, 69654081], [saleDate, 2, , 40118, 40118], [quantity, 3, , 1, 1], [price, 4, , 12990, 12990]]')
		click('Right')
		click('Right')
		select('Table', 'cell:Data,0(8)')
		select('Table', 'cell:Len,2()')
		assert_p('Table', 'Content', '[[quantity, 1, , 8, 8], [price, 2, , 166940, 166940], [count, 3, , 10, 10]]')
		select('Table', 'cell:Len,2()')
		select_menu('Utilities>>Compare with Disk')
##		select('Table1', 'cell:Len,2()')
		select('Table', 'cell:keycode,5()')
##		assert_p('Table', 'Content', '[[, Deleted, 1, 70, Department: 70, , ], [, , , , , , ], [, Deleted, 2, 64614285, 40118, 1, 22990], [, , , , , , ], [, Deleted, 3, 67654448, 40118, 1, 23000], [, , , , , , ], [, Deleted, 4, 67654448, 40118, -1, -23000], [, , , , , , ], [, Deleted, 5, 67654448, 40118, 1, 19010], [, , , , , , ], [, Deleted, 6, 68614241, 40118, 1, 12990], [, , , , , , ], [, Deleted, 7, 68614787, 40118, 1, 27990], [, , , , , , ], [, Deleted, 8, 68634061, 40118, 1, 27990], [, , , , , , ], [, Deleted, 9, 69644337, 40118, 1, 29990], [, , , , , , ], [, Deleted, 10, 69654081, 40118, 1, 12990], [, , , , , , ], [, Deleted, 11, 69654135, 40118, 1, 12990], [, , , , , , ], [, Deleted, 12, 8, 166940, 10, ], [, , , , , , ], [, Deleted, 13, 80, Department: 80, , ], [, , , , , , ], [, Deleted, 14, 68664957, 40118, 1, 13990], [, , , , , , ], [, Deleted, 15, 69634699, 40118, 1, 20990], [, , , , , , ], [, Deleted, 16, 69634712, 40118, 1, 20990], [, , , , , , ], [, Deleted, 17, 3, 55970, 3, ], [, , , , , , ], [, Deleted, 56, 70, Department: 70, , ], [, , , , , , ], [, Deleted, 57, 64614285, 40118, 1, 22990], [, , , , , , ], [, Deleted, 58, 67654448, 40118, 1, 23000], [, , , , , , ], [, Deleted, 59, 67654448, 40118, -1, -23000], [, , , , , , ], [, Deleted, 60, 67654448, 40118, 1, 19010], [, , , , , , ], [, Deleted, 61, 68614241, 40118, 1, 12990], [, , , , , , ], [, Deleted, 62, 68614787, 40118, 1, 27990], [, , , , , , ], [, Deleted, 63, 68634061, 40118, 1, 27990], [, , , , , , ], [, Deleted, 64, 69644337, 40118, 1, 29990], [, , , , , , ], [, Deleted, 65, 69654081, 40118, 1, 12990], [, , , , , , ], [, Deleted, 66, 69654135, 40118, 1, 12990], [, , , , , , ], [, Deleted, 67, 8, 166940, 10, ], [, , , , , , ], [, Deleted, 68, 80, Department: 80, , ], [, , , , , , ], [, Deleted, 69, 68664957, 40118, 1, 13990], [, , , , , , ], [, Deleted, 70, 69634699, 40118, 1, 20990], [, , , , , , ], [, Deleted, 71, 69634712, 40118, 1, 20990], [, , , , , , ], [, Deleted, 72, 3, 55970, 3, ], [, , , , , , ]]')
##		assert_p('Table', 'Content', '[[, Deleted, 39, 70, Department: 70, , ], [, , , , , , ], [, Deleted, 40, 64614285, 40118, 1, 22990], [, , , , , , ], [, Deleted, 41, 67654448, 40118, 1, 23000], [, , , , , , ], [, Deleted, 42, 67654448, 40118, -1, -23000], [, , , , , , ], [, Deleted, 43, 67654448, 40118, 1, 19010], [, , , , , , ], [, Deleted, 44, 68614241, 40118, 1, 12990], [, , , , , , ], [, Deleted, 45, 68614787, 40118, 1, 27990], [, , , , , , ], [, Deleted, 46, 68634061, 40118, 1, 27990], [, , , , , , ], [, Deleted, 47, 69644337, 40118, 1, 29990], [, , , , , , ], [, Deleted, 48, 69654081, 40118, 1, 12990], [, , , , , , ], [, Deleted, 49, 69654135, 40118, 1, 12990], [, , , , , , ], [, Deleted, 50, 8, 166940, 10, ], [, , , , , , ], [, Deleted, 51, 80, Department: 80, , ], [, , , , , , ], [, Deleted, 52, 68664957, 40118, 1, 13990], [, , , , , , ], [, Deleted, 53, 69634699, 40118, 1, 20990], [, , , , , , ], [, Deleted, 54, 69634712, 40118, 1, 20990], [, , , , , , ], [, Deleted, 55, 3, 55970, 3, ], [, , , , , , ]]')

		assert_p('Table', 'Content', '[[, , , , , , ], [, Inserted, 39, 70, Department: 70, , ], [, , , , , , ], [, Inserted, 40, 64614285, 40118, 1, 22990], [, , , , , , ], [, Inserted, 41, 67654448, 40118, 1, 23000], [, , , , , , ], [, Inserted, 42, 67654448, 40118, -1, -23000], [, , , , , , ], [, Inserted, 43, 67654448, 40118, 1, 19010], [, , , , , , ], [, Inserted, 44, 68614241, 40118, 1, 12990], [, , , , , , ], [, Inserted, 45, 68614787, 40118, 1, 27990], [, , , , , , ], [, Inserted, 46, 68634061, 40118, 1, 27990], [, , , , , , ], [, Inserted, 47, 69644337, 40118, 1, 29990], [, , , , , , ], [, Inserted, 48, 69654081, 40118, 1, 12990], [, , , , , , ], [, Inserted, 49, 69654135, 40118, 1, 12990], [, , , , , , ], [, Inserted, 50, 8, 166940, 10, ], [, , , , , , ], [, Inserted, 51, 80, Department: 80, , ], [, , , , , , ], [, Inserted, 52, 68664957, 40118, 1, 13990], [, , , , , , ], [, Inserted, 53, 69634699, 40118, 1, 20990], [, , , , , , ], [, Inserted, 54, 69634712, 40118, 1, 20990], [, , , , , , ], [, Inserted, 55, 3, 55970, 3, ]]')


##		select('Table', 'cell:keycode,5()')
##		click('ScrollPane$ScrollBar', 11, 324)
		click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('Table', 'cell:Len,2()')

	close()
