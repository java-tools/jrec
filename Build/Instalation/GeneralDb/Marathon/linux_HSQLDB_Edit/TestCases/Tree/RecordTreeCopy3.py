useFixture(default)

def test():
	from Modules import commonBits
	java_recorded_version = '1.5.0_11'

	if window('Record Editor'):
		select('FileChooser', commonBits.sampleDir() + 'Ams_PODownload_20041231.txt')
		click('Edit1')
		select_menu('View>>Record Based Tree')
		select('Table', '1', 'Parent Record,0')
		select('Table', '0', 'Parent Record,2')
		select('Table', 'cell:Parent Record,2(0)')
		click('Build')
		select('JTreeTable', 'cell:Sequence Number,1(45.350)')
		rightclick('JTreeTable', 'Sequence Number,1')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Sequence Number,2(0.016)')
		rightclick('JTreeTable', 'Sequence Number,2')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Sequence Number,3(50.190)')
		assert_p('JTreeTable', 'Text', '50.190', 'Sequence Number,3')
		select('JTreeTable', 'cell:Sequence Number,4(51.710)')
		assert_p('JTreeTable', 'Content', '[[, , H1, 45.349, 6060, 286225, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , H1, 45.350, 6228, 222227, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , D1, 0.016, 6228, 148320000000, 000022, 22 02224, 53, 10, 0000, 005454, 000001, ,    207, 5, 348, , 56], [, , S1, 50.190, 1503, 700000001507, 400000, 00150780, 00, 00, 0015, 085000, 000015, 0, 000001, 5, 0930000000, 1, 50], [, , S1, 51.710, 1517, 700000001508, 900000, 00151360, 00, 00, 0015, 145000, 000015, 0, 000001, ,    0000000, 0, ], [, , D1, 0.008, 0, 148320000000, 000000, 00 62224, 94, 40, 0000, 005454, 000000, ,    207, 5, 349, , 65], [, , D1, 0.108, 0, 148320000000, 000000, 00 62225, 07, 10, 0000, 005454, 000010, ,    207, 5, 350, , 65], [, , D1, 0.008, 0, 148320000000, 000000, 00 52225, 15, 60, 0000, 005454, 000000, ,    207, 5, 351, , 55], [, , H1, 45.351, 6228, 222243, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , H1, 45.352, 5341, 294915, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.353, 5341, 294987, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.354, 5341, 295139, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.355, 5341, 303662, 041110, , 00, , 310, 041231, 050107, P, , , YOUTH SHOE, C, FT], [, , H1, 45.356, 5341, 304100, 041111, , 00, , 310, 041231, 050107, P, , , YOUTH SHOE, C, FT]]')
		select('JTreeTable', 'cell:Sequence Number,3(50.190)')
		rightclick('JTreeTable', 'Sequence Number,3')
		select_menu('Copy Record#{s#}')
		select('JTreeTable', 'cell:Sequence Number,4(51.710)')
		rightclick('JTreeTable', 'Sequence Number,4')
		select_menu('Paste Record#{s#}')
		select('JTreeTable', 'cell:Record Type,2(D1)')
		rightclick('JTreeTable', 'Sequence Number,2')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Sequence Number,5(50.190)')
		assert_p('JTreeTable', 'Content', '[[, , H1, 45.349, 6060, 286225, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , H1, 45.350, 6228, 222227, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , D1, 0.016, 6228, 148320000000, 000022, 22 02224, 53, 10, 0000, 005454, 000001, ,    207, 5, 348, , 56], [, , S1, 50.190, 1503, 700000001507, 400000, 00150780, 00, 00, 0015, 085000, 000015, 0, 000001, 5, 0930000000, 1, 50], [, , S1, 51.710, 1517, 700000001508, 900000, 00151360, 00, 00, 0015, 145000, 000015, 0, 000001, ,    0000000, 0, ], [, , S1, 50.190, 1503, 700000001507, 400000, 00150780, 00, 00, 0015, 085000, 000015, 0, 000001, 5, 0930000000, 1, 50], [, , D1, 0.008, 0, 148320000000, 000000, 00 62224, 94, 40, 0000, 005454, 000000, ,    207, 5, 349, , 65], [, , D1, 0.108, 0, 148320000000, 000000, 00 62225, 07, 10, 0000, 005454, 000010, ,    207, 5, 350, , 65], [, , D1, 0.008, 0, 148320000000, 000000, 00 52225, 15, 60, 0000, 005454, 000000, ,    207, 5, 351, , 55], [, , H1, 45.351, 6228, 222243, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , H1, 45.352, 5341, 294915, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.353, 5341, 294987, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.354, 5341, 295139, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.355, 5341, 303662, 041110, , 00, , 310, 041231, 050107, P, , , YOUTH SHOE, C, FT], [, , H1, 45.356, 5341, 304100, 041111, , 00, , 310, 041231, 050107, P, , , YOUTH SHOE, C, FT]]')
		select('JTreeTable', 'cell:Sequence Number,4(51.710)')
		assert_p('JTreeTable', 'RowCount', '15')
		select('JTreeTable', 'cell:Sequence Number,5(50.190)')
		assert_p('JTreeTable', 'Text', '0.008', 'Sequence Number,6')
		select('JTreeTable', 'cell:Sequence Number,4(51.710)')
		rightclick('JTreeTable', 'Sequence Number,4')
		select_menu('Copy Record#{s#}')
		select('JTreeTable', 'cell:Sequence Number,3(50.190)')
		rightclick('JTreeTable', 'Sequence Number,3')
		select_menu('Paste Record#{s#} Prior')
		select('JTreeTable', 'cell:Sequence Number,2(0.016)')
		rightclick('JTreeTable', 'Sequence Number,2')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Sequence Number,3(51.710)')
		assert_p('JTreeTable', 'Text', '50.190', 'Sequence Number,4')
		select('JTreeTable', 'cell:Sequence Number,4(50.190)')
		assert_p('JTreeTable', 'RowCount', '16')
		select('JTreeTable', 'cell:Sequence Number,5(51.710)')
		assert_p('JTreeTable', 'Content', '[[, , H1, 45.349, 6060, 286225, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , H1, 45.350, 6228, 222227, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , D1, 0.016, 6228, 148320000000, 000022, 22 02224, 53, 10, 0000, 005454, 000001, ,    207, 5, 348, , 56], [, , S1, 51.710, 1517, 700000001508, 900000, 00151360, 00, 00, 0015, 145000, 000015, 0, 000001, ,    0000000, 0, ], [, , S1, 50.190, 1503, 700000001507, 400000, 00150780, 00, 00, 0015, 085000, 000015, 0, 000001, 5, 0930000000, 1, 50], [, , S1, 51.710, 1517, 700000001508, 900000, 00151360, 00, 00, 0015, 145000, 000015, 0, 000001, ,    0000000, 0, ], [, , S1, 50.190, 1503, 700000001507, 400000, 00150780, 00, 00, 0015, 085000, 000015, 0, 000001, 5, 0930000000, 1, 50], [, , D1, 0.008, 0, 148320000000, 000000, 00 62224, 94, 40, 0000, 005454, 000000, ,    207, 5, 349, , 65], [, , D1, 0.108, 0, 148320000000, 000000, 00 62225, 07, 10, 0000, 005454, 000010, ,    207, 5, 350, , 65], [, , D1, 0.008, 0, 148320000000, 000000, 00 52225, 15, 60, 0000, 005454, 000000, ,    207, 5, 351, , 55], [, , H1, 45.351, 6228, 222243, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , H1, 45.352, 5341, 294915, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.353, 5341, 294987, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.354, 5341, 295139, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.355, 5341, 303662, 041110, , 00, , 310, 041231, 050107, P, , , YOUTH SHOE, C, FT], [, , H1, 45.356, 5341, 304100, 041111, , 00, , 310, 041231, 050107, P, , , YOUTH SHOE, C, FT]]')
		select('JTreeTable', 'rows:[3,4,5],columns:[Sequence Number]')
		rightclick('JTreeTable', 'Sequence Number,4')
		select_menu('Copy Record#{s#}')
		select('JTreeTable', 'cell:Sequence Number,7(0.008)')
		rightclick('JTreeTable', 'Sequence Number,7')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Sequence Number,8(50.190)')
		rightclick('JTreeTable', 'Sequence Number,8')
		select_menu('Paste Record#{s#}')
		select('JTreeTable', 'cell:Record Type,3(D1)')
		rightclick('JTreeTable', 'Record Type,3')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Sequence Number,5(51.710)')
		assert_p('JTreeTable', 'Text', '50.190', 'Sequence Number,6')
		select('JTreeTable', 'cell:Sequence Number,6(50.190)')
		assert_p('JTreeTable', 'Content', '[[, , H1, 45.349, 6060, 286225, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , H1, 45.350, 6228, 222227, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , D1, 0.016, 6228, 148320000000, 000022, 22 02224, 53, 10, 0000, 005454, 000001, ,    207, 5, 348, , 56], [, , D1, 0.008, 0, 148320000000, 000000, 00 62224, 94, 40, 0000, 005454, 000000, ,    207, 5, 349, , 65], [, , S1, 50.190, 1503, 700000001507, 800000, 00150910, 00, 00, 0015, 093000, 000015, 0, 000001, 5, 1770000000, 1, 51], [, , S1, 51.710, 1517, 700000001508, 900000, 00151360, 00, 00, 0015, 145000, 000015, 0, 000001, ,    0000000, 0, ], [, , S1, 50.190, 1503, 700000001507, 400000, 00150780, 00, 00, 0015, 085000, 000015, 0, 000001, 5, 0930000000, 1, 50], [, , S1, 51.710, 1517, 700000001508, 900000, 00151360, 00, 00, 0015, 145000, 000015, 0, 000001, ,    0000000, 0, ], [, , D1, 0.108, 0, 148320000000, 000000, 00 62225, 07, 10, 0000, 005454, 000010, ,    207, 5, 350, , 65], [, , D1, 0.008, 0, 148320000000, 000000, 00 52225, 15, 60, 0000, 005454, 000000, ,    207, 5, 351, , 55], [, , H1, 45.351, 6228, 222243, 040909, , 00, , 200, 050102, 050107, , , , LADIES KNI, C, FT], [, , H1, 45.352, 5341, 294915, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.353, 5341, 294987, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.354, 5341, 295139, 041013, , 00, , 475, 041231, 050107, P, , , WOMENS SHO, C, FT], [, , H1, 45.355, 5341, 303662, 041110, , 00, , 310, 041231, 050107, P, , , YOUTH SHOE, C, FT], [, , H1, 45.356, 5341, 304100, 041111, , 00, , 310, 041231, 050107, P, , , YOUTH SHOE, C, FT]]')
		select('JTreeTable', 'cell:Sequence Number,2(0.016)')
		select_menu('View>>Table View #{Selected Records#}')
		select('JTreeTable', 'cell:Sequence Number,2(0.016)')
		select('Table', 'cell:15 - 4|DC Number 2,0(2281)')
		assert_p('Table', 'Text', '5177', '15 - 4|DC Number 2,1')
		select('Table', 'cell:15 - 4|DC Number 2,1(5177)')
		assert_p('Table', 'Content', '[[D1, 1, 60000006, 2281, 48320000, 0222, 45310000, 5, 45400000, 16, 207, 5348, , 5614, 531, D, ONKEY 24, -6, 607 SHWL], [S1, 5171, 1, 5177, 1, 5136, 1, 5145, 1, 5096, 1, , 0, , 0, , 0, , 0], [S1, 5019, 1, 5037, 1, 5078, 1, 5085, 1, 5091, 1, 5093, 1, 5095, 1, 51 D, ONKEY 24, -6, 607 SHWL], [S1, 5171, 1, 5177, 1, 5136, 1, 5145, 1, 5096, 1, , 0, , 0, , 0, , 0], [S1, 5019, 1, 5037, 1, 5078, 1, 5085, 1, 5091, 1, 5093, 1, 5095, 1, 51 D, ONKEY 24, -6, 607 SHWL]]')
		select('Table', 'cell:15 - 4|DC Number 2,1(5177)')
		click('BasicInternalFrameTitlePane$NoFocusButton2')
		select('JTreeTable', 'cell:Sequence Number,5(51.710)')
		rightclick('JTreeTable', 'Sequence Number,5')
		select_menu('Copy Record#{s#}')
		select('JTreeTable', 'cell:Sequence Number,3(0.008)')
		rightclick('JTreeTable', 'Sequence Number,3')
		select_menu('Collapse Tree')
		select('JTreeTable', 'cell:Sequence Number,6(45.351)')
		rightclick('JTreeTable', 'Sequence Number,6')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Sequence Number,7(0.006)')
		rightclick('JTreeTable', 'Sequence Number,7')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Sequence Number,9(0.003)')
		rightclick('JTreeTable', 'Sequence Number,9')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Sequence Number,8(50.090)')
		rightclick('JTreeTable', 'Sequence Number,8')
		select_menu('Paste Record#{s#} Prior')
		select('JTreeTable', 'cell:Sequence Number,7(0.006)')
		rightclick('JTreeTable', 'Sequence Number,7')
		select_menu('Expand Tree')
		select('JTreeTable', 'cell:Sequence Number,8(51.710)')
		assert_p('JTreeTable', 'Text', '50.090', 'Sequence Number,9')
		select('JTreeTable', 'cell:Sequence Number,7(0.006)')
		rightclick('JTreeTable', 'Sequence Number,7')
		select_menu('Collapse Tree')
		select('JTreeTable', 'cell:Sequence Number,7(0.006)')
		select_menu('View>>Table View #{Selected Records#}')
		select('JTreeTable', 'cell:Sequence Number,7(0.006)')
		select('Table', 'cell:15 - 4|DC Number 2,1(5177)')
		assert_p('Table', 'Text', '5021', '15 - 4|DC Number 2,2')
		select('Table', 'cell:15 - 4|DC Number 2,2(5021)')
		select('Table', 'cell:7 - 8|Pack Quantity 1,1(1)')
		assert_p('Table', 'Content', '[[D1, 0, 60000000, 1, 48320000, 4561, 45310000, 5, 45400000, 6, 207, 5352, , 4561, 4531, D, ONKEY 24, -6, 607 SHWL], [S1, 5171, 1, 5177, 1, 5136, 1, 5145, 1, 5096, 1, , 0, , 0, , 0, , 0], [S1, 5009, 1, 5021, 1, 5025, 1, 5026, 1, 5127, 1, , 0, , 0, , 0, , 0]]')
		select('Table', 'cell:7 - 8|Pack Quantity 1,1(1)')
		click('BasicInternalFrameTitlePane$NoFocusButton2')
		click('BasicInternalFrameTitlePane$NoFocusButton2')
		click('BasicInternalFrameTitlePane$NoFocusButton2')

		if window('Save Changes to file: ' + commonBits.sampleDir() + 'Ams_PODownload_20041231.txt'):
			click('No')
		close()
	close()
