useFixture(default)


def test():
	from Modules import commonBits
	java_recorded_version = '1.6.0_10'

	if window('Record Editor'):
		select_menu('File>>File Copy Menu')
		click('*1')
		select('FileChooser', commonBits.sampleDir() + 'DTAR020.bin')
		commonBits.setMainframeCobolLayout(select, 'DTAR020')
		click('Right')
		select('TabbedPane', '')
		select('FileChooser', commonBits.sampleDir() + 'zzzXfeReverse3DTAR020a.csv')
#		click('ScrollPane$ScrollBar', 4, 51)
#		select('ComboBox2', 'XfeDTAR020_reverse')
		commonBits.setRecordLayout2(select, 'XfeDTAR020_reverse')
		if commonBits.isJRecord():
			click('Right')

		click('Right')
		select('TabbedPane', '')
		select('Table1', 'cell:Field,1(STORE-NO)')
		assert_p('Table1', 'Content', '[[KEYCODE-NO, KEYCODE-NO], [STORE-NO, STORE-NO], [DATE, DATE], [DEPT-NO, DEPT-NO], [QTY-SOLD, QTY-SOLD], [SALE-PRICE, SALE-PRICE]]')
#		select('Table1', '')
		select('Table', 'cell:Record,0(DTAR020)')
		doubleclick('Table', 'Record,0')
		select('Table', 'cell:Record,0(DTAR020)')
		doubleclick('Table', 'Record,0')
		assert_p('Table', 'Content', '[[DTAR020, XfeDTAR020_reverse]]')
		select('Table', 'cell:Record,0(DTAR020)')
		click('Right')
		select('TabbedPane', '')
#		click('Choose File')

#		if window('Open'):
#			click('Cancel')
#		close()


		select('FileChooser', commonBits.userDir() + 'copyDTAR020toCsv1.xml')
		click('Save1')
		click('BasicInternalFrameTitlePane$NoFocusButton2')
		select_menu('Window>>Menu>>Copy Menu')
		click('*')
		select('FileChooser', commonBits.userDir() + 'copyDTAR020toCsv1.xml')
		click('Run Copy Dialog')
		assert_p('FileChooser', 'Text', commonBits.sampleDir() + 'DTAR020.bin')
		if commonBits.isRecordEditor():
			assert_p('ComboBox2', 'Text', 'DTAR020')
		click('Right')
		select('TabbedPane', '')
		assert_p('FileChooser', 'Text', commonBits.sampleDir() + 'zzzXfeReverse3DTAR020a.csv')
#		select('ComboBox2', 'Generic CSV - enter details')
#		click('ScrollPane$ScrollBar', 8, 60)
#		click('ScrollPane$ScrollBar', 8, 74)
#		click('ScrollPane$ScrollBar', 8, 81)
#		click('ScrollPane$ScrollBar', 8, 81)
		if commonBits.isRecordEditor():
			assert_p('ComboBox2', 'Text', 'XfeDTAR020_reverse')
		click('Right')
		select('TabbedPane', '')
		select('Table1', 'cell:Field,1(STORE-NO)')
		assert_p('Table1', 'Content', '[[KEYCODE-NO, KEYCODE-NO], [STORE-NO, STORE-NO], [DATE, DATE], [DEPT-NO, DEPT-NO], [QTY-SOLD, QTY-SOLD], [SALE-PRICE, SALE-PRICE]]')
#		select('Table1', '')
		select('Table', 'cell:Record,0(DTAR020)')
		doubleclick('Table', 'Record,0')
		assert_p('Table', 'Content', '[[DTAR020, XfeDTAR020_reverse]]')
		select('Table', 'cell:Record,0(DTAR020)')
		click('Right')
		select('TabbedPane', '')
		click('Copy2')
		assert_p('TextField1', 'Text', 'Copy Done !!! ')
		click('BasicInternalFrameTitlePane$NoFocusButton2')
		click('Open')
##		click('MetalInternalFrameTitlePane', 105, 4)
		select('FileChooser', commonBits.sampleDir() + 'zzzXfeReverse3DTAR020a.csv')
		commonBits.setRecordLayout(select, 'XfeDTAR020_reverse')

#		click('ScrollPane$ScrollBar', 9, 93)

#		click('ScrollPane$ScrollBar', 9, 102)
#		click('ScrollPane$ScrollBar', 9, 102)
#		click('ScrollPane$ScrollBar', 6, 92)
		click('Edit1')
		select('Table', 'cell:2|SALE-PRICE,0(19.00)')
		assert_p('Table', 'Text', '5.01', '2|SALE-PRICE,2')
		select('Table', 'cell:2|SALE-PRICE,0(19.00)')
		rightclick('Table', '2|SALE-PRICE,1')
		select('Table', 'cell:2|SALE-PRICE,1(-19.00)')
		assert_p('Table', 'RowCount', '379')
		select('Table', 'cell:2|SALE-PRICE,2(5.01)')
		assert_p('Table', 'ColumnCount', '6')
		select('Table', 'rows:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],columns:[2|SALE-PRICE]')
		select_menu('View>>Table View #{Selected Records#}')
#		select('Table2', 'rows:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],columns:[2|SALE-PRICE]')
		select('Table', 'cell:2|SALE-PRICE,2(4.87)')
		assert_p('Table', 'Content', '[[-1, -19.00, 280, 40118, 20, 69694158], [1, 5.01, 280, 40118, 20, 69694158], [1, 4.87, 170, 40118, 20, 63604808], [1, 69.99, 685, 40118, 20, 62684671], [-1, -69.99, 685, 40118, 20, 62684671], [1, 3.99, 957, 40118, 20, 64634429], [1, 0.89, 957, 40118, 20, 66624458], [10, 2.70, 957, 40118, 20, 63674861], [1, 3.59, 929, 40118, 20, 65674532], [1, 1.99, 957, 40118, 59, 64614401], [1, 1.99, 957, 40118, 59, 64614401], [1, 17.99, 335, 40118, 59, 61664713], [-1, -17.99, 335, 40118, 59, 61664713], [1, 8.99, 410, 40118, 59, 68634752], [1, 5.95, 878, 40118, 59, 60614487], [1, 12.65, 878, 40118, 59, 63644339], [1, 3.99, 620, 40118, 59, 60694698]]')
		select('Table', 'cell:2|SALE-PRICE,2(4.87)')
		click('BasicInternalFrameTitlePane$NoFocusButton2')
#		select('Table', 'rows:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],columns:[2|SALE-PRICE]')
#		select('Table', 'rows:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],columns:[2|SALE-PRICE]')
		select_menu('Window>>zzzXfeReverse3DTAR020a.csv>>Table: ')
		select('Table', 'cell:2|SALE-PRICE,16(-17.99)')
		rightclick('Table', '2|SALE-PRICE,16')
		select_menu('Edit Record')
##		select('Table1', 'cell:2|SALE-PRICE,16(-17.99)')
		select('Table', 'cell:Data,1(-17.99)')
		assert_p('Table', 'Text', 'cell:Data,1(-17.99)')
		select('Table', 'cell:Data,2(335)')
		assert_p('Table', 'Content', '[[QTY-SOLD, 1, , -1, -1], [SALE-PRICE, 2, , -17.99, -17.99], [DEPT-NO, 3, , 335, 335], [DATE, 4, , 40118, 40118], [STORE-NO, 5, , 59, 59], [KEYCODE-NO, 6, , 61664713, 61664713]]')
		select('Table', 'cell:Data,2(335)')
		click('HexThreeLineField')
		assert_p('HexThreeLineField', 'Text', '''-1þ-17.99þ335þ40118þ59þ61664713
23f233233f333f33333f33f33333333
d1ed17e99e335e40118e59e61664713''')
		click('Right')
		select('Table', 'cell:Data,5(68634752)')
		assert_p('Table', 'Text', 'cell:Data,5(68634752)')
		select('Table', 'cell:Data,3(40118)')
		assert_p('Table', 'Content', '[[QTY-SOLD, 1, , 1, 1], [SALE-PRICE, 2, , 8.99, 8.99], [DEPT-NO, 3, , 410, 410], [DATE, 4, , 40118, 40118], [STORE-NO, 5, , 59, 59], [KEYCODE-NO, 6, , 68634752, 68634752]]')
		select('Table', 'cell:Data,3(40118)')
		click('HexThreeLineField')
		assert_p('HexThreeLineField', 'Text', '''1þ8.99þ410þ40118þ59þ68634752
3f3233f333f33333f33f33333333
1e8e99e410e40118e59e68634752''')
		click('Right')
		select('Table', 'cell:Data,3(40118)')
		assert_p('Table', 'Content', '[[QTY-SOLD, 1, , 1, 1], [SALE-PRICE, 2, , 5.95, 5.95], [DEPT-NO, 3, , 878, 878], [DATE, 4, , 40118, 40118], [STORE-NO, 5, , 59, 59], [KEYCODE-NO, 6, , 60614487, 60614487]]')
		select('Table', 'cell:Data,3(40118)')
		click('HexThreeLineField')
		assert_p('HexThreeLineField', 'Text', '''1þ5.95þ878þ40118þ59þ60614487
3f3233f333f33333f33f33333333
1e5e95e878e40118e59e60614487''')
		click('Right')
		select('Table', 'cell:Data,3(40118)')
		assert_p('Table', 'Content', '[[QTY-SOLD, 1, , 1, 1], [SALE-PRICE, 2, , 12.65, 12.65], [DEPT-NO, 3, , 878, 878], [DATE, 4, , 40118, 40118], [STORE-NO, 5, , 59, 59], [KEYCODE-NO, 6, , 63644339, 63644339]]')
		select('Table', 'cell:Data,3(40118)')
		click('HexThreeLineField')
		assert_p('HexThreeLineField', 'Text', '''1þ12.65þ878þ40118þ59þ63644339
3f33233f333f33333f33f33333333
1e12e65e878e40118e59e63644339''')
		click('Right')
		select('Table', 'cell:Data,1(3.99)')
		assert_p('Table', 'Content', '[[QTY-SOLD, 1, , 1, 1], [SALE-PRICE, 2, , 3.99, 3.99], [DEPT-NO, 3, , 620, 620], [DATE, 4, , 40118, 40118], [STORE-NO, 5, , 59, 59], [KEYCODE-NO, 6, , 60694698, 60694698]]')
		select('Table', 'cell:Data,1(3.99)')
		click('HexThreeLineField')
		assert_p('HexThreeLineField', 'Text', '''1þ3.99þ620þ40118þ59þ60694698
3f3233f333f33333f33f33333333
1e3e99e620e40118e59e60694698''')
		click('Right')
		select('Table', 'cell:Data,3(40118)')
		assert_p('Table', 'Content', '[[QTY-SOLD, 1, , 1, 1], [SALE-PRICE, 2, , 3.99, 3.99], [DEPT-NO, 3, , 620, 620], [DATE, 4, , 40118, 40118], [STORE-NO, 5, , 59, 59], [KEYCODE-NO, 6, , 60664659, 60664659]]')
		select('Table', 'cell:Data,3(40118)')
		click('HexThreeLineField')
		assert_p('HexThreeLineField', 'Text', '''1þ3.99þ620þ40118þ59þ60664659
3f3233f333f33333f33f33333333
1e3e99e620e40118e59e60664659''')
		click('Right')
		select('Table', 'cell:Data,5(62684217)')
		assert_p('Table', 'Content', '[[QTY-SOLD, 1, , 1, 1], [SALE-PRICE, 2, , 9.99, 9.99], [DEPT-NO, 3, , 957, 957], [DATE, 4, , 40118, 40118], [STORE-NO, 5, , 59, 59], [KEYCODE-NO, 6, , 62684217, 62684217]]')
		select('Table', 'cell:Data,5(62684217)')
		click('HexThreeLineField')
		assert_p('HexThreeLineField', 'Text', '''1þ9.99þ957þ40118þ59þ62684217
3f3233f333f33333f33f33333333
1e9e99e957e40118e59e62684217''')
		click('Right')
		select('Table', 'cell:Data,3(40118)')
		assert_p('Table', 'Content', '[[QTY-SOLD, 1, , 1, 1], [SALE-PRICE, 2, , 3.99, 3.99], [DEPT-NO, 3, , 929, 929], [DATE, 4, , 40118, 40118], [STORE-NO, 5, , 59, 59], [KEYCODE-NO, 6, , 67674686, 67674686]]')
		select('Table', 'cell:Data,3(40118)')
		click('HexThreeLineField')
		assert_p('HexThreeLineField', 'Text', '''1þ3.99þ929þ40118þ59þ67674686
3f3233f333f33333f33f33333333
1e3e99e929e40118e59e67674686''')
		click('Right')
		select('Table', 'cell:Data,5(61684613)')
		select('Table', 'cell:Data,2(335)')
		assert_p('Table', 'Content', '[[QTY-SOLD, 1, , 1, 1], [SALE-PRICE, 2, , 12.99, 12.99], [DEPT-NO, 3, , 335, 335], [DATE, 4, , 40118, 40118], [STORE-NO, 5, , 59, 59], [KEYCODE-NO, 6, , 61684613, 61684613]]')
		select('Table', 'cell:Data,2(335)')
		click('HexThreeLineField')
		assert_p('HexThreeLineField', 'Text', '''1þ12.99þ335þ40118þ59þ61684613
3f33233f333f33333f33f33333333
1e12e99e335e40118e59e61684613''')
		click('Right')
		select('Table', 'cell:Data,3(40118)')
		assert_p('Table', 'Content', '[[QTY-SOLD, 1, , 1, 1], [SALE-PRICE, 2, , 2.59, 2.59], [DEPT-NO, 3, , 957, 957], [DATE, 4, , 40118, 40118], [STORE-NO, 5, , 59, 59], [KEYCODE-NO, 6, , 64624770, 64624770]]')
		select('Table', 'cell:Data,3(40118)')
		click('HexThreeLineField')
		assert_p('HexThreeLineField', 'Text', '''1þ2.59þ957þ40118þ59þ64624770
3f3233f333f33333f33f33333333
1e2e59e957e40118e59e64624770''')
	close()
